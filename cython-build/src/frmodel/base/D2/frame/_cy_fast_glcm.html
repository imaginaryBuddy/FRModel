<!DOCTYPE html>
<!-- Generated by Cython 0.29.32 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: _cy_fast_glcm.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.cython .hll { background-color: #ffffcc }
.cython { background: #f8f8f8; }
.cython .c { color: #3D7B7B; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #9C6500 } /* Comment.Preproc */
.cython .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.cython .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #E40000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #008400 } /* Generic.Inserted */
.cython .go { color: #717171 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #687822 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #717171; font-weight: bold } /* Name.Entity */
.cython .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #767600 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #A45A77 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.32</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="_cy_fast_glcm.c">_cy_fast_glcm.c</a></p>
<div class="cython"><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-16 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">004</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="n">DTYPE_t8</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_uint8_t __pyx_t_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_DTYPE_t8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">005</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16_t</span> <span class="n">DTYPE_t16</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_uint16_t __pyx_t_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_DTYPE_t16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">006</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">DTYPE_t32</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_uint32_t __pyx_t_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_DTYPE_t32;
</pre><pre class="cython line score-0">&#xA0;<span class="">007</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">float32_t</span> <span class="n">DTYPE_ft32</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: <span class="k">from</span> <span class="nn">cython.parallel</span> <span class="k">cimport</span> <span class="n">prange</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">009</span>: <span class="k">from</span> <span class="nn">tqdm</span> <span class="k">import</span> <span class="n">tqdm</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_tqdm);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_tqdm);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_tqdm);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_tqdm, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_tqdm);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_tqdm, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">010</span>: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">sqrt</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">014</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-89" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">015</span>: <span class="k">def</span> <span class="nf">cy_fast_glcm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t8</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">5</span><span class="p">]</span> <span class="n">windows_i</span><span class="p">,</span></pre>
<pre class='cython code score-89 '>/* Python wrapper */
static PyObject *__pyx_pw_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_1cy_fast_glcm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_cy_fast_glcm[] = " Fast GLCM Calculation in Cython. Inspired by Wang Jifei's Fast GLCM code.\n\n    This MUST be implemented within controlled environments in Fast GLCM, else\n    certain assumptions are not held.\n\n    Windows must be 5 dims.\n    (1) Window Row (2) Window Col (3) Cell Row (4) Cell Col (5) Channel\n\n    Window values should not exceed uint16 size.\n\n    The result array should be given.\n    This is to make it easier to do Cython\n    (1) Combination Array (2) Window Row (3) Window Col (4) Channel\n\n    Result values should not exceed uint8 size.\n    This will rarely happen, almost negligible.\n\n    Results will only exceed if the window size &gt; 255 and all values happen to be the same.\n\n    ";
static PyMethodDef __pyx_mdef_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_1cy_fast_glcm = {"cy_fast_glcm", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_1cy_fast_glcm, METH_VARARGS|METH_KEYWORDS, __pyx_doc_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_cy_fast_glcm};
static PyObject *__pyx_pw_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_1cy_fast_glcm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_windows_i = 0;
  PyArrayObject *__pyx_v_windows_j = 0;
  int __pyx_v_verbose;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cy_fast_glcm (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_windows_i,&amp;__pyx_n_s_windows_j,&amp;__pyx_n_s_verbose,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_windows_i)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_windows_j)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cy_fast_glcm", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_verbose)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cy_fast_glcm", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cy_fast_glcm") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_windows_i = ((PyArrayObject *)values[0]);
    __pyx_v_windows_j = ((PyArrayObject *)values[1]);
    __pyx_v_verbose = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(values[2]); if (unlikely((__pyx_v_verbose == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cy_fast_glcm", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("FRModel.src.frmodel.base.D2.frame._cy_fast_glcm.cy_fast_glcm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_windows_i), __pyx_ptype_5numpy_ndarray, 1, "windows_i", 0))) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_windows_j), __pyx_ptype_5numpy_ndarray, 1, "windows_j", 0))) <span class='error_goto'>__PYX_ERR(0, 16, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_cy_fast_glcm(__pyx_self, __pyx_v_windows_i, __pyx_v_windows_j, __pyx_v_verbose);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_cy_fast_glcm(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_windows_i, PyArrayObject *__pyx_v_windows_j, int __pyx_v_verbose) {
  __Pyx_memviewslice __pyx_v_i_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_j_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  unsigned short __pyx_v_window_rows;
  unsigned short __pyx_v_window_cols;
  short __pyx_v_wi_r;
  short __pyx_v_wi_c;
  CYTHON_UNUSED unsigned int __pyx_v_cell_rows;
  CYTHON_UNUSED unsigned int __pyx_v_cell_cols;
  short __pyx_v_c_r;
  short __pyx_v_c_c;
  unsigned char __pyx_v_channels;
  char __pyx_v_ch;
  short __pyx_v_i;
  short __pyx_v_j;
  float __pyx_v_glcm_val;
  float __pyx_v_mean_i_val;
  float __pyx_v_mean_j_val;
  float __pyx_v_var_i_val;
  float __pyx_v_var_j_val;
  char __pyx_v_glcm_max_value;
  PyObject *__pyx_v_glcm = NULL;
  PyObject *__pyx_v_contrast = NULL;
  PyObject *__pyx_v_correlation = NULL;
  PyObject *__pyx_v_asm = NULL;
  PyObject *__pyx_v_mean = NULL;
  PyObject *__pyx_v_mean_i = NULL;
  PyObject *__pyx_v_mean_j = NULL;
  PyObject *__pyx_v_var = NULL;
  PyObject *__pyx_v_var_i = NULL;
  PyObject *__pyx_v_var_j = NULL;
  __Pyx_memviewslice __pyx_v_glcm_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_contrast_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_correlation_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_asm_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_mean_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_mean_i_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_mean_j_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_var_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_var_i_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_var_j_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_LocalBuf_ND __pyx_pybuffernd_windows_i;
  __Pyx_Buffer __pyx_pybuffer_windows_i;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_windows_j;
  __Pyx_Buffer __pyx_pybuffer_windows_j;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cy_fast_glcm", 0);
  __pyx_pybuffer_windows_i.pybuffer.buf = NULL;
  __pyx_pybuffer_windows_i.refcount = 0;
  __pyx_pybuffernd_windows_i.data = NULL;
  __pyx_pybuffernd_windows_i.rcbuffer = &amp;__pyx_pybuffer_windows_i;
  __pyx_pybuffer_windows_j.pybuffer.buf = NULL;
  __pyx_pybuffer_windows_j.refcount = 0;
  __pyx_pybuffernd_windows_j.data = NULL;
  __pyx_pybuffernd_windows_j.rcbuffer = &amp;__pyx_pybuffer_windows_j;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_windows_i.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_windows_i, &amp;__Pyx_TypeInfo_nn___pyx_t_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_DTYPE_t8, PyBUF_FORMAT| PyBUF_STRIDES, 5, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_windows_i.diminfo[0].strides = __pyx_pybuffernd_windows_i.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_windows_i.diminfo[0].shape = __pyx_pybuffernd_windows_i.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_windows_i.diminfo[1].strides = __pyx_pybuffernd_windows_i.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_windows_i.diminfo[1].shape = __pyx_pybuffernd_windows_i.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_windows_i.diminfo[2].strides = __pyx_pybuffernd_windows_i.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_windows_i.diminfo[2].shape = __pyx_pybuffernd_windows_i.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_windows_i.diminfo[3].strides = __pyx_pybuffernd_windows_i.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_windows_i.diminfo[3].shape = __pyx_pybuffernd_windows_i.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_windows_i.diminfo[4].strides = __pyx_pybuffernd_windows_i.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_windows_i.diminfo[4].shape = __pyx_pybuffernd_windows_i.rcbuffer-&gt;pybuffer.shape[4];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_windows_j.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_windows_j, &amp;__Pyx_TypeInfo_nn___pyx_t_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_DTYPE_t8, PyBUF_FORMAT| PyBUF_STRIDES, 5, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_windows_j.diminfo[0].strides = __pyx_pybuffernd_windows_j.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_windows_j.diminfo[0].shape = __pyx_pybuffernd_windows_j.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_windows_j.diminfo[1].strides = __pyx_pybuffernd_windows_j.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_windows_j.diminfo[1].shape = __pyx_pybuffernd_windows_j.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_windows_j.diminfo[2].strides = __pyx_pybuffernd_windows_j.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_windows_j.diminfo[2].shape = __pyx_pybuffernd_windows_j.rcbuffer-&gt;pybuffer.shape[2]; __pyx_pybuffernd_windows_j.diminfo[3].strides = __pyx_pybuffernd_windows_j.rcbuffer-&gt;pybuffer.strides[3]; __pyx_pybuffernd_windows_j.diminfo[3].shape = __pyx_pybuffernd_windows_j.rcbuffer-&gt;pybuffer.shape[3]; __pyx_pybuffernd_windows_j.diminfo[4].strides = __pyx_pybuffernd_windows_j.rcbuffer-&gt;pybuffer.strides[4]; __pyx_pybuffernd_windows_j.diminfo[4].shape = __pyx_pybuffernd_windows_j.rcbuffer-&gt;pybuffer.shape[4];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_windows_i.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_windows_j.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("FRModel.src.frmodel.base.D2.frame._cy_fast_glcm.cy_fast_glcm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_windows_i.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_windows_j.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_i_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_j_v, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_glcm);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_contrast);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_correlation);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_asm);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mean);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mean_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mean_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_var);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_var_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_var_j);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_glcm_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_contrast_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_correlation_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_asm_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_mean_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_mean_i_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_mean_j_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_var_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_var_i_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_var_j_v, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(43, __pyx_n_s_windows_i, __pyx_n_s_windows_j, __pyx_n_s_verbose, __pyx_n_s_i_v, __pyx_n_s_j_v, __pyx_n_s_window_rows, __pyx_n_s_window_cols, __pyx_n_s_wi_r, __pyx_n_s_wi_c, __pyx_n_s_cell_rows, __pyx_n_s_cell_cols, __pyx_n_s_c_r, __pyx_n_s_c_c, __pyx_n_s_channels, __pyx_n_s_ch, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_glcm_val, __pyx_n_s_mean_i_val, __pyx_n_s_mean_j_val, __pyx_n_s_var_i_val, __pyx_n_s_var_j_val, __pyx_n_s_glcm_max_value, __pyx_n_s_glcm, __pyx_n_s_contrast, __pyx_n_s_correlation, __pyx_n_s_asm, __pyx_n_s_mean, __pyx_n_s_mean_i, __pyx_n_s_mean_j, __pyx_n_s_var, __pyx_n_s_var_i, __pyx_n_s_var_j, __pyx_n_s_glcm_v, __pyx_n_s_contrast_v, __pyx_n_s_correlation_v, __pyx_n_s_asm_v, __pyx_n_s_mean_v, __pyx_n_s_mean_i_v, __pyx_n_s_mean_j_v, __pyx_n_s_var_v, __pyx_n_s_var_i_v, __pyx_n_s_var_j_v);<span class='error_goto'> if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_1cy_fast_glcm, NULL, __pyx_n_s_FRModel_src_frmodel_base_D2_fram);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cy_fast_glcm, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__24 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 43, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_frmodel_base_D2_frame__cy_fa, __pyx_n_s_cy_fast_glcm, 15, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">016</span>:                  <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t8</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">5</span><span class="p">]</span> <span class="n">windows_j</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>:                  <span class="nb">bint</span> <span class="n">verbose</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">018</span>:     <span class="sd">&quot;&quot;&quot; Fast GLCM Calculation in Cython. Inspired by Wang Jifei&#39;s Fast GLCM code.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">019</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>: <span class="sd">    This MUST be implemented within controlled environments in Fast GLCM, else</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>: <span class="sd">    certain assumptions are not held.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>: <span class="sd">    Windows must be 5 dims.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>: <span class="sd">    (1) Window Row (2) Window Col (3) Cell Row (4) Cell Col (5) Channel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: <span class="sd">    Window values should not exceed uint16 size.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>: <span class="sd">    The result array should be given.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>: <span class="sd">    This is to make it easier to do Cython</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>: <span class="sd">    (1) Combination Array (2) Window Row (3) Window Col (4) Channel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">032</span>: <span class="sd">    Result values should not exceed uint8 size.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">033</span>: <span class="sd">    This will rarely happen, almost negligible.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">035</span>: <span class="sd">    Results will only exceed if the window size &gt; 255 and all values happen to be the same.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">036</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">037</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>:     <span class="c"># Cython doesn&#39;t allow .shape == .shape for some reason, so we just compare them</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>:     <span class="c"># iteratively.</span></pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">041</span>:     <span class="k">assert</span> <span class="n">windows_i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">windows_j</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">f</span><span class="s">&quot;Fast GLCM Dim 0 Mismatch {windows_i.shape[0]}, {windows_j.shape[0]}&quot;</span></pre>
<pre class='cython code score-42 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!(((__pyx_v_windows_i-&gt;dimensions[0]) == (__pyx_v_windows_j-&gt;dimensions[0])) != 0))) {
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = 0;
      __pyx_t_3 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Fast_GLCM_Dim_0_Mismatch);
      __pyx_t_2 += 25;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Fast_GLCM_Dim_0_Mismatch);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_Fast_GLCM_Dim_0_Mismatch);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_windows_i-&gt;dimensions[0]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_4, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) : __pyx_t_3;
      __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);
      __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_);
      __pyx_t_2 += 2;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_windows_j-&gt;dimensions[0]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_5, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) : __pyx_t_3;
      __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='error_goto'>__PYX_ERR(0, 41, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">042</span>:     <span class="k">assert</span> <span class="n">windows_i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">windows_j</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="n">f</span><span class="s">&quot;Fast GLCM Dim 1 Mismatch {windows_i.shape[1]}, {windows_j.shape[1]}&quot;</span></pre>
<pre class='cython code score-42 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!(((__pyx_v_windows_i-&gt;dimensions[1]) == (__pyx_v_windows_j-&gt;dimensions[1])) != 0))) {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_2 = 0;
      __pyx_t_3 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Fast_GLCM_Dim_1_Mismatch);
      __pyx_t_2 += 25;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Fast_GLCM_Dim_1_Mismatch);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_kp_u_Fast_GLCM_Dim_1_Mismatch);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_windows_i-&gt;dimensions[1]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) : __pyx_t_3;
      __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5);
      __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_);
      __pyx_t_2 += 2;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_kp_u_);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_windows_j-&gt;dimensions[1]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_5, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_3;
      __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 3, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_4, 4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='error_goto'>__PYX_ERR(0, 42, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">043</span>:     <span class="k">assert</span> <span class="n">windows_i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">windows_j</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span> <span class="n">f</span><span class="s">&quot;Fast GLCM Dim 2 Mismatch {windows_i.shape[2]}, {windows_j.shape[2]}&quot;</span></pre>
<pre class='cython code score-42 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!(((__pyx_v_windows_i-&gt;dimensions[2]) == (__pyx_v_windows_j-&gt;dimensions[2])) != 0))) {
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = 0;
      __pyx_t_3 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Fast_GLCM_Dim_2_Mismatch);
      __pyx_t_2 += 25;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Fast_GLCM_Dim_2_Mismatch);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_Fast_GLCM_Dim_2_Mismatch);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_windows_i-&gt;dimensions[2]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_4, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) : __pyx_t_3;
      __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);
      __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_);
      __pyx_t_2 += 2;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_windows_j-&gt;dimensions[2]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_5, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) : __pyx_t_3;
      __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='error_goto'>__PYX_ERR(0, 43, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">044</span>:     <span class="k">assert</span> <span class="n">windows_i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">windows_j</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">3</span><span class="p">],</span> <span class="n">f</span><span class="s">&quot;Fast GLCM Dim 3 Mismatch {windows_i.shape[3]}, {windows_j.shape[3]}&quot;</span></pre>
<pre class='cython code score-42 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!(((__pyx_v_windows_i-&gt;dimensions[3]) == (__pyx_v_windows_j-&gt;dimensions[3])) != 0))) {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_2 = 0;
      __pyx_t_3 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Fast_GLCM_Dim_3_Mismatch);
      __pyx_t_2 += 25;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Fast_GLCM_Dim_3_Mismatch);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_kp_u_Fast_GLCM_Dim_3_Mismatch);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_windows_i-&gt;dimensions[3]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) : __pyx_t_3;
      __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5);
      __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_);
      __pyx_t_2 += 2;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_kp_u_);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_windows_j-&gt;dimensions[3]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_5, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_3;
      __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 3, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_4, 4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='error_goto'>__PYX_ERR(0, 44, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">045</span>:     <span class="k">assert</span> <span class="n">windows_i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span> <span class="o">==</span> <span class="n">windows_j</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">4</span><span class="p">],</span> <span class="n">f</span><span class="s">&quot;Fast GLCM Dim 4 Mismatch {windows_i.shape[4]}, {windows_j.shape[4]}&quot;</span></pre>
<pre class='cython code score-42 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!(((__pyx_v_windows_i-&gt;dimensions[4]) == (__pyx_v_windows_j-&gt;dimensions[4])) != 0))) {
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = 0;
      __pyx_t_3 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Fast_GLCM_Dim_4_Mismatch);
      __pyx_t_2 += 25;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Fast_GLCM_Dim_4_Mismatch);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_Fast_GLCM_Dim_4_Mismatch);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_windows_i-&gt;dimensions[4]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_4, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) : __pyx_t_3;
      __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);
      __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_);
      __pyx_t_2 += 2;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_windows_j-&gt;dimensions[4]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_5, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) : __pyx_t_3;
      __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='error_goto'>__PYX_ERR(0, 45, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">046</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>:     <span class="c"># Used to call these windows_a and windows_b, but it&#39;s easier if it follows the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">048</span>:     <span class="c"># tutorial&#39;s naming convention.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">049</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_t8</span> [<span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="n">i_v</span> <span class="o">=</span> <span class="n">windows_i</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsds_nn___pyx_t_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_DTYPE_t8(((PyObject *)__pyx_v_windows_i), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 49, __pyx_L1_error)</span>
  __pyx_v_i_v = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">050</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_t8</span> [<span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="n">j_v</span> <span class="o">=</span> <span class="n">windows_j</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsds_nn___pyx_t_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_DTYPE_t8(((PyObject *)__pyx_v_windows_j), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 50, __pyx_L1_error)</span>
  __pyx_v_j_v = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">051</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">052</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="nf">window_rows</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span> <span class="n">windows_i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_window_rows = ((unsigned int)(__pyx_v_windows_i-&gt;dimensions[0]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">053</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="nf">window_cols</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span> <span class="n">windows_i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_window_cols = ((unsigned int)(__pyx_v_windows_i-&gt;dimensions[1]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">054</span>:     <span class="k">cdef</span> <span class="kt">short</span> <span class="nf">wi_r</span> <span class="o">=</span> <span class="mf">0</span><span class="p">,</span> <span class="n">wi_c</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_wi_r = 0;
  __pyx_v_wi_c = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">055</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">056</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">cell_rows</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span> <span class="n">windows_i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_cell_rows = ((unsigned int)(__pyx_v_windows_i-&gt;dimensions[2]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">057</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">cell_cols</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span> <span class="n">windows_i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_cell_cols = ((unsigned int)(__pyx_v_windows_i-&gt;dimensions[3]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">058</span>:     <span class="k">cdef</span> <span class="kt">short</span> <span class="nf">c_r</span> <span class="o">=</span> <span class="mf">0</span><span class="p">,</span> <span class="n">c_c</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_c_r = 0;
  __pyx_v_c_c = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">059</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">060</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">channels</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">char</span><span class="p">&gt;</span><span class="n">windows_i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_channels = ((char)(__pyx_v_windows_i-&gt;dimensions[4]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">061</span>:     <span class="k">cdef</span> <span class="kt">char</span> <span class="nf">ch</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ch = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">062</span>:     <span class="k">cdef</span> <span class="kt">short</span> <span class="nf">i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">063</span>:     <span class="k">cdef</span> <span class="kt">short</span> <span class="nf">j</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_j = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">064</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">065</span>:     <span class="c"># Vals are just temporary variables so as to facilitate clean code.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">066</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">glcm_val</span>   <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_glcm_val = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">067</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">mean_i_val</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_mean_i_val = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">068</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">mean_j_val</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_mean_j_val = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">069</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">var_i_val</span>  <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_var_i_val = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">070</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">var_j_val</span>  <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_var_j_val = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">071</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>:     <span class="c"># Finds the maximum out of the 2 windows</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>:     <span class="c"># We do this instead of a user input because it&#39;s cheap and it reduces the required amount of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>:     <span class="c"># windows to the minimal.</span></pre>
<pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">075</span>:     <span class="k">cdef</span> <span class="kt">char</span> <span class="nf">glcm_max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">windows_i</span><span class="p">,</span> <span class="n">windows_j</span><span class="p">])</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-40 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 75, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 75, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 75, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_windows_i));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_windows_i));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_windows_i));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_windows_j));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_windows_j));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_windows_j));
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 75, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_4, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 75, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_As_char</span>(__pyx_t_5); if (unlikely((__pyx_t_8 == (char)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 75, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_glcm_max_value = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">076</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">077</span>:     <span class="n">glcm</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">glcm_max_value</span><span class="p">,</span> <span class="n">glcm_max_value</span><span class="p">,</span></pre>
<pre class='cython code score-30 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 77, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 77, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_char</span>(__pyx_v_glcm_max_value);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 77, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_char</span>(__pyx_v_glcm_max_value);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 77, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_t_11 = <span class='py_c_api'>PyList_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 77, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 3, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 4, __pyx_t_10);
  __pyx_t_5 = 0;
  __pyx_t_1 = 0;
  __pyx_t_7 = 0;
  __pyx_t_9 = 0;
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 77, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_11);
  __pyx_t_11 = 0;
/* … */
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_10, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 77, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_v_glcm = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">078</span>:                             <span class="n">window_rows</span><span class="p">,</span> <span class="n">window_cols</span><span class="p">,</span> <span class="n">channels</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_rows);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_cols);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_char</span>(__pyx_v_channels);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
/* … */
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_uint8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">079</span>:     <span class="n">contrast</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">window_rows</span><span class="p">,</span> <span class="n">window_cols</span><span class="p">,</span> <span class="n">channels</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_rows);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_cols);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_char</span>(__pyx_v_channels);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 2, __pyx_t_4);
  __pyx_t_7 = 0;
  __pyx_t_10 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_4, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_contrast = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">080</span>:     <span class="n">correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">window_rows</span><span class="p">,</span> <span class="n">window_cols</span><span class="p">,</span> <span class="n">channels</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_rows);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_cols);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_char</span>(__pyx_v_channels);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 2, __pyx_t_11);
  __pyx_t_7 = 0;
  __pyx_t_4 = 0;
  __pyx_t_11 = 0;
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_11, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_v_correlation = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">081</span>:     <span class="n">asm</span>         <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">window_rows</span><span class="p">,</span> <span class="n">window_cols</span><span class="p">,</span> <span class="n">channels</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 81, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 81, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_rows);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 81, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_cols);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 81, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_char</span>(__pyx_v_channels);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 81, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 81, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_9);
  __pyx_t_7 = 0;
  __pyx_t_11 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 81, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 81, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 81, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 81, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 81, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_9, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 81, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_asm = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">082</span>:     <span class="n">mean</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">window_rows</span><span class="p">,</span> <span class="n">window_cols</span><span class="p">,</span> <span class="n">channels</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_rows);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_cols);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_char</span>(__pyx_v_channels);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_11 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_10);
  __pyx_t_7 = 0;
  __pyx_t_9 = 0;
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_11);
  __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_10, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_v_mean = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">083</span>:     <span class="n">mean_i</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">window_rows</span><span class="p">,</span> <span class="n">window_cols</span><span class="p">,</span> <span class="n">channels</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_rows);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_cols);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_char</span>(__pyx_v_channels);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 2, __pyx_t_4);
  __pyx_t_7 = 0;
  __pyx_t_10 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_4, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_mean_i = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">084</span>:     <span class="n">mean_j</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">window_rows</span><span class="p">,</span> <span class="n">window_cols</span><span class="p">,</span> <span class="n">channels</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_rows);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_cols);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_char</span>(__pyx_v_channels);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 2, __pyx_t_11);
  __pyx_t_7 = 0;
  __pyx_t_4 = 0;
  __pyx_t_11 = 0;
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_11, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_v_mean_j = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">085</span>:     <span class="n">var</span>         <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">window_rows</span><span class="p">,</span> <span class="n">window_cols</span><span class="p">,</span> <span class="n">channels</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_rows);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_cols);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_char</span>(__pyx_v_channels);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_9);
  __pyx_t_7 = 0;
  __pyx_t_11 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_9, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_var = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>:     <span class="n">var_i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">window_rows</span><span class="p">,</span> <span class="n">window_cols</span><span class="p">,</span> <span class="n">channels</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_rows);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_cols);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_char</span>(__pyx_v_channels);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_11 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_10);
  __pyx_t_7 = 0;
  __pyx_t_9 = 0;
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_11);
  __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_10, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_v_var_i = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">087</span>:     <span class="n">var_j</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">window_rows</span><span class="p">,</span> <span class="n">window_cols</span><span class="p">,</span> <span class="n">channels</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_rows);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_cols);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_char</span>(__pyx_v_channels);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 2, __pyx_t_4);
  __pyx_t_7 = 0;
  __pyx_t_10 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_4, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_var_j = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">088</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">089</span>:     <span class="c"># We declare all of the required Views here.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">090</span>:     <span class="c"># All views are prepended with _v.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">092</span>:     <span class="c"># To Clarify, GLCM uses these as Dimensions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">093</span>:     <span class="c"># i, j, wi_r, wi_c, ch</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">094</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">char</span>  [<span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="n">glcm_v</span>        <span class="o">=</span> <span class="n">glcm</span></pre>
<pre class='cython code score-2 '>  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsds_unsigned_char</span>(__pyx_v_glcm, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 94, __pyx_L1_error)</span>
  __pyx_v_glcm_v = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">095</span>:     <span class="k">cdef</span> <span class="kt">float</span>          [<span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>       <span class="n">contrast_v</span>    <span class="o">=</span> <span class="n">contrast</span></pre>
<pre class='cython code score-2 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_contrast, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 95, __pyx_L1_error)</span>
  __pyx_v_contrast_v = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">096</span>:     <span class="k">cdef</span> <span class="kt">float</span>          [<span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>       <span class="n">correlation_v</span> <span class="o">=</span> <span class="n">correlation</span></pre>
<pre class='cython code score-2 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_correlation, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 96, __pyx_L1_error)</span>
  __pyx_v_correlation_v = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">097</span>:     <span class="k">cdef</span> <span class="kt">float</span>          [<span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>       <span class="n">asm_v</span>         <span class="o">=</span> <span class="n">asm</span></pre>
<pre class='cython code score-2 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_asm, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 97, __pyx_L1_error)</span>
  __pyx_v_asm_v = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">098</span>:     <span class="k">cdef</span> <span class="kt">float</span>          [<span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>       <span class="n">mean_v</span>        <span class="o">=</span> <span class="n">mean</span></pre>
<pre class='cython code score-2 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_mean, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 98, __pyx_L1_error)</span>
  __pyx_v_mean_v = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">099</span>:     <span class="k">cdef</span> <span class="kt">float</span>          [<span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>       <span class="n">mean_i_v</span>      <span class="o">=</span> <span class="n">mean_i</span></pre>
<pre class='cython code score-2 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_mean_i, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
  __pyx_v_mean_i_v = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">100</span>:     <span class="k">cdef</span> <span class="kt">float</span>          [<span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>       <span class="n">mean_j_v</span>      <span class="o">=</span> <span class="n">mean_j</span></pre>
<pre class='cython code score-2 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_mean_j, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 100, __pyx_L1_error)</span>
  __pyx_v_mean_j_v = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">101</span>:     <span class="k">cdef</span> <span class="kt">float</span>          [<span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>       <span class="n">var_v</span>         <span class="o">=</span> <span class="n">var</span></pre>
<pre class='cython code score-2 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_var, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  __pyx_v_var_v = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">102</span>:     <span class="k">cdef</span> <span class="kt">float</span>          [<span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>       <span class="n">var_i_v</span>       <span class="o">=</span> <span class="n">var_i</span></pre>
<pre class='cython code score-2 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_var_i, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  __pyx_v_var_i_v = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">103</span>:     <span class="k">cdef</span> <span class="kt">float</span>          [<span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>       <span class="n">var_j_v</span>       <span class="o">=</span> <span class="n">var_j</span></pre>
<pre class='cython code score-2 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_var_j, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  __pyx_v_var_j_v = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">104</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>:     <span class="c"># ------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">106</span>:     <span class="c"># GLCM CONSTRUCTION</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">107</span>:     <span class="c"># ------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">108</span>:     <span class="c"># This is the part where GLCM is for loop generated.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">109</span>:     <span class="c"># It&#39;s very quick actually.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">110</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">111</span>:     <span class="c"># The outer loop is required for verbose tqdm</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">112</span>:     <span class="c"># prange will not work if there are any Python objects within</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">113</span>:     <span class="c"># So the options are exclusive, but verbose is more important</span></pre>
<pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>:     <span class="k">for</span> <span class="n">wi_r</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">window_rows</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">,</span></pre>
<pre class='cython code score-84 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_tqdm);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_rows);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((!(__pyx_v_verbose != 0)));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_disable, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_desc, __pyx_kp_s_GLCM_Construction_Pass) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_9, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_11)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_11)) {
    __pyx_t_4 = __pyx_t_11; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2 = 0;
    __pyx_t_14 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_14 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  for (;;) {
    if (likely(!__pyx_t_14)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_2++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
        #else
        __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        #endif
      } else {
        if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_2++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
        #else
        __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        #endif
      }
    } else {
      __pyx_t_11 = __pyx_t_14(__pyx_t_4);
      if (unlikely(!__pyx_t_11)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    }
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyInt_As_short</span>(__pyx_t_11); if (unlikely((__pyx_t_15 == (short)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_v_wi_r = __pyx_t_15;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">115</span>:                      <span class="n">desc</span><span class="o">=</span><span class="s">&quot;GLCM Construction Pass&quot;</span><span class="p">):</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">116</span>:         <span class="k">for</span> <span class="n">wi_c</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">window_cols</span><span class="p">,</span> <span class="k">nogil</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
        #endif
        /*try:*/ {
          __pyx_t_16 = __pyx_v_window_cols;
          if ((1 == 0)) abort();
          {
              #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                  #undef likely
                  #undef unlikely
                  #define likely(x)   (x)
                  #define unlikely(x) (x)
              #endif
              __pyx_t_18 = (__pyx_t_16 - 0 + 1 - 1/abs(1)) / 1;
              if (__pyx_t_18 &gt; 0)
              {
                  #ifdef _OPENMP
                  #pragma omp parallel
                  #endif /* _OPENMP */
                  {
                      #ifdef _OPENMP
                      #pragma omp for lastprivate(__pyx_v_c_c) lastprivate(__pyx_v_c_r) lastprivate(__pyx_v_ch) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) firstprivate(__pyx_v_wi_c) lastprivate(__pyx_v_wi_c) schedule(dynamic)
                      #endif /* _OPENMP */
                      for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_18; __pyx_t_17++){
                          {
                              __pyx_v_wi_c = (short)(0 + 1 * __pyx_t_17);
                              /* Initialize private variables to invalid values */
                              __pyx_v_c_c = ((short)0xbad0bad0);
                              __pyx_v_c_r = ((short)0xbad0bad0);
                              __pyx_v_ch = ((char)'?');
                              __pyx_v_i = ((short)0xbad0bad0);
                              __pyx_v_j = ((short)0xbad0bad0);
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L9;
          }
          __pyx_L9:;
        }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">117</span>:             <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_19 = __pyx_v_channels;
                              if ((1 == 0)) abort();
                              {
                                  __pyx_t_21 = (__pyx_t_19 - 0 + 1 - 1/abs(1)) / 1;
                                  if (__pyx_t_21 &gt; 0)
                                  {
                                      #if 0
                                      #pragma omp parallel
                                      #endif /* _OPENMP */
                                      {
                                          #if 0
                                          #pragma omp for lastprivate(__pyx_v_c_c) lastprivate(__pyx_v_c_r) firstprivate(__pyx_v_ch) lastprivate(__pyx_v_ch) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) schedule(dynamic)
                                          #endif /* _OPENMP */
                                          for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_21; __pyx_t_20++){
                                              {
                                                  __pyx_v_ch = (char)(0 + 1 * __pyx_t_20);
                                                  /* Initialize private variables to invalid values */
                                                  __pyx_v_c_c = ((short)0xbad0bad0);
                                                  __pyx_v_c_r = ((short)0xbad0bad0);
                                                  __pyx_v_i = ((short)0xbad0bad0);
                                                  __pyx_v_j = ((short)0xbad0bad0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">118</span>:                 <span class="k">for</span> <span class="n">c_r</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">cell_rows</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                                                  __pyx_t_22 = __pyx_v_cell_rows;
                                                  if ((1 == 0)) abort();
                                                  {
                                                      __pyx_t_24 = (__pyx_t_22 - 0 + 1 - 1/abs(1)) / 1;
                                                      if (__pyx_t_24 &gt; 0)
                                                      {
                                                          #if 0
                                                          #pragma omp parallel
                                                          #endif /* _OPENMP */
                                                          {
                                                              #if 0
                                                              #pragma omp for lastprivate(__pyx_v_c_c) firstprivate(__pyx_v_c_r) lastprivate(__pyx_v_c_r) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) schedule(dynamic)
                                                              #endif /* _OPENMP */
                                                              for (__pyx_t_23 = 0; __pyx_t_23 &lt; __pyx_t_24; __pyx_t_23++){
                                                                  {
                                                                      __pyx_v_c_r = (short)(0 + 1 * __pyx_t_23);
                                                                      /* Initialize private variables to invalid values */
                                                                      __pyx_v_c_c = ((short)0xbad0bad0);
                                                                      __pyx_v_i = ((short)0xbad0bad0);
                                                                      __pyx_v_j = ((short)0xbad0bad0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">119</span>:                     <span class="k">for</span> <span class="n">c_c</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">cell_cols</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                                                                      __pyx_t_25 = __pyx_v_cell_cols;
                                                                      if ((1 == 0)) abort();
                                                                      {
                                                                          __pyx_t_27 = (__pyx_t_25 - 0 + 1 - 1/abs(1)) / 1;
                                                                          if (__pyx_t_27 &gt; 0)
                                                                          {
                                                                              #if 0
                                                                              #pragma omp parallel
                                                                              #endif /* _OPENMP */
                                                                              {
                                                                                  #if 0
                                                                                  #pragma omp for firstprivate(__pyx_v_c_c) lastprivate(__pyx_v_c_c) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) schedule(dynamic)
                                                                                  #endif /* _OPENMP */
                                                                                  for (__pyx_t_26 = 0; __pyx_t_26 &lt; __pyx_t_27; __pyx_t_26++){
                                                                                      {
                                                                                          __pyx_v_c_c = (short)(0 + 1 * __pyx_t_26);
                                                                                          /* Initialize private variables to invalid values */
                                                                                          __pyx_v_i = ((short)0xbad0bad0);
                                                                                          __pyx_v_j = ((short)0xbad0bad0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">120</span>:                         <span class="n">i</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">short</span><span class="p">&gt;</span><span class="n">i_v</span><span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">c_r</span><span class="p">,</span> <span class="n">c_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                                                                          __pyx_t_28 = __pyx_v_wi_r;
                                                                                          __pyx_t_29 = __pyx_v_wi_c;
                                                                                          __pyx_t_30 = __pyx_v_c_r;
                                                                                          __pyx_t_31 = __pyx_v_c_c;
                                                                                          __pyx_t_32 = __pyx_v_ch;
                                                                                          __pyx_v_i = ((short)(*((__pyx_t_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_DTYPE_t8 *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_i_v.data + __pyx_t_28 * __pyx_v_i_v.strides[0]) ) + __pyx_t_29 * __pyx_v_i_v.strides[1]) ) + __pyx_t_30 * __pyx_v_i_v.strides[2]) ) + __pyx_t_31 * __pyx_v_i_v.strides[3]) ) + __pyx_t_32 * __pyx_v_i_v.strides[4]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">121</span>:                         <span class="n">j</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">short</span><span class="p">&gt;</span><span class="n">j_v</span><span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">c_r</span><span class="p">,</span> <span class="n">c_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                                                                          __pyx_t_32 = __pyx_v_wi_r;
                                                                                          __pyx_t_31 = __pyx_v_wi_c;
                                                                                          __pyx_t_30 = __pyx_v_c_r;
                                                                                          __pyx_t_29 = __pyx_v_c_c;
                                                                                          __pyx_t_28 = __pyx_v_ch;
                                                                                          __pyx_v_j = ((short)(*((__pyx_t_7FRModel_3src_7frmodel_4base_2D2_5frame_13_cy_fast_glcm_DTYPE_t8 *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_j_v.data + __pyx_t_32 * __pyx_v_j_v.strides[0]) ) + __pyx_t_31 * __pyx_v_j_v.strides[1]) ) + __pyx_t_30 * __pyx_v_j_v.strides[2]) ) + __pyx_t_29 * __pyx_v_j_v.strides[3]) ) + __pyx_t_28 * __pyx_v_j_v.strides[4]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">122</span>:                         <span class="n">glcm_v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>                                                                                          __pyx_t_28 = __pyx_v_i;
                                                                                          __pyx_t_29 = __pyx_v_j;
                                                                                          __pyx_t_30 = __pyx_v_wi_r;
                                                                                          __pyx_t_31 = __pyx_v_wi_c;
                                                                                          __pyx_t_32 = __pyx_v_ch;
                                                                                          *((unsigned char *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_glcm_v.data + __pyx_t_28 * __pyx_v_glcm_v.strides[0]) ) + __pyx_t_29 * __pyx_v_glcm_v.strides[1]) ) + __pyx_t_30 * __pyx_v_glcm_v.strides[2]) ) + __pyx_t_31 * __pyx_v_glcm_v.strides[3]) ) + __pyx_t_32 * __pyx_v_glcm_v.strides[4]) )) += 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">123</span>:                         <span class="n">glcm_v</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>                                                                                          __pyx_t_32 = __pyx_v_j;
                                                                                          __pyx_t_31 = __pyx_v_i;
                                                                                          __pyx_t_30 = __pyx_v_wi_r;
                                                                                          __pyx_t_29 = __pyx_v_wi_c;
                                                                                          __pyx_t_28 = __pyx_v_ch;
                                                                                          *((unsigned char *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_glcm_v.data + __pyx_t_32 * __pyx_v_glcm_v.strides[0]) ) + __pyx_t_31 * __pyx_v_glcm_v.strides[1]) ) + __pyx_t_30 * __pyx_v_glcm_v.strides[2]) ) + __pyx_t_29 * __pyx_v_glcm_v.strides[3]) ) + __pyx_t_28 * __pyx_v_glcm_v.strides[4]) )) += 1;
                                                                                      }
                                                                                  }
                                                                              }
                                                                          }
                                                                      }
                                                                  }
                                                              }
                                                          }
                                                      }
                                                  }
                                              }
                                          }
                                      }
                                  }
                              }
                          }
                      }
                  }
              }
          }
          #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
              #undef likely
              #undef unlikely
              #define likely(x)   __builtin_expect(!!(x), 1)
              #define unlikely(x) __builtin_expect(!!(x), 0)
          #endif
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">124</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">125</span>:     <span class="c"># ------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">126</span>:     <span class="c"># CONTRAST, ASM, MEAN</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">127</span>:     <span class="c"># ------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">128</span>:     <span class="c"># Contrast and ASM is generated here.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">129</span>:     <span class="c"># Correlation takes 3 passes, for the detailed explanation, read the journal.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">130</span>:     <span class="c"># In simple words, Corr needs the variance, variance needs the mean, so it requires</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">131</span>:     <span class="c"># multiple passes for Corr to be done.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">132</span>: </pre>
<pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">133</span>:     <span class="k">for</span> <span class="n">wi_r</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">window_rows</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">,</span></pre>
<pre class='cython code score-84 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_tqdm);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_rows);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((!(__pyx_v_verbose != 0)));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_disable, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_desc, __pyx_kp_s_GLCM_Contrast_ASM_Mean_Pass) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 133, __pyx_L1_error)</span>
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_11, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7)) {
    __pyx_t_9 = __pyx_t_7; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_2 = 0;
    __pyx_t_14 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_14 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  for (;;) {
    if (likely(!__pyx_t_14)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
        if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_9)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_2++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 133, __pyx_L1_error)</span>
        #else
        __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        #endif
      } else {
        if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_9)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_2++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 133, __pyx_L1_error)</span>
        #else
        __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        #endif
      }
    } else {
      __pyx_t_7 = __pyx_t_14(__pyx_t_9);
      if (unlikely(!__pyx_t_7)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 133, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    }
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyInt_As_short</span>(__pyx_t_7); if (unlikely((__pyx_t_15 == (short)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 133, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_wi_r = __pyx_t_15;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">134</span>:                      <span class="n">desc</span><span class="o">=</span><span class="s">&quot;GLCM Contrast, ASM, Mean Pass&quot;</span><span class="p">):</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:         <span class="k">for</span> <span class="n">wi_c</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">window_cols</span><span class="p">,</span> <span class="k">nogil</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-6 '>    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
        #endif
        /*try:*/ {
          __pyx_t_18 = __pyx_v_window_cols;
          if ((1 == 0)) abort();
          {
              #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                  #undef likely
                  #undef unlikely
                  #define likely(x)   (x)
                  #define unlikely(x) (x)
              #endif
              __pyx_t_16 = (__pyx_t_18 - 0 + 1 - 1/abs(1)) / 1;
              if (__pyx_t_16 &gt; 0)
              {
                  #ifdef _OPENMP
                  #pragma omp parallel
                  #endif /* _OPENMP */
                  {
                      #ifdef _OPENMP
                      #pragma omp for lastprivate(__pyx_v_ch) lastprivate(__pyx_v_glcm_val) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) firstprivate(__pyx_v_wi_c) lastprivate(__pyx_v_wi_c) schedule(dynamic)
                      #endif /* _OPENMP */
                      for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17++){
                          {
                              __pyx_v_wi_c = (short)(0 + 1 * __pyx_t_17);
                              /* Initialize private variables to invalid values */
                              __pyx_v_ch = ((char)'?');
                              __pyx_v_glcm_val = ((float)__PYX_NAN());
                              __pyx_v_i = ((short)0xbad0bad0);
                              __pyx_v_j = ((short)0xbad0bad0);
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L40;
          }
          __pyx_L39_error: {
            #ifdef WITH_THREAD
            <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L1_error;
          }
          __pyx_L40:;
        }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">136</span>:             <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_21 = __pyx_v_channels;
                              if ((1 == 0)) abort();
                              {
                                  __pyx_t_19 = (__pyx_t_21 - 0 + 1 - 1/abs(1)) / 1;
                                  if (__pyx_t_19 &gt; 0)
                                  {
                                      #if 0
                                      #pragma omp parallel
                                      #endif /* _OPENMP */
                                      {
                                          #if 0
                                          #pragma omp for firstprivate(__pyx_v_ch) lastprivate(__pyx_v_ch) lastprivate(__pyx_v_glcm_val) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) schedule(dynamic)
                                          #endif /* _OPENMP */
                                          for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_19; __pyx_t_20++){
                                              {
                                                  __pyx_v_ch = (char)(0 + 1 * __pyx_t_20);
                                                  /* Initialize private variables to invalid values */
                                                  __pyx_v_glcm_val = ((float)__PYX_NAN());
                                                  __pyx_v_i = ((short)0xbad0bad0);
                                                  __pyx_v_j = ((short)0xbad0bad0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">137</span>:                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">glcm_max_value</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                                                  __pyx_t_8 = __pyx_v_glcm_max_value;
                                                  if ((1 == 0)) abort();
                                                  {
                                                      __pyx_t_33 = (__pyx_t_8 - 0 + 1 - 1/abs(1)) / 1;
                                                      if (__pyx_t_33 &gt; 0)
                                                      {
                                                          #if 0
                                                          #pragma omp parallel
                                                          #endif /* _OPENMP */
                                                          {
                                                              #if 0
                                                              #pragma omp for lastprivate(__pyx_v_glcm_val) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) schedule(dynamic)
                                                              #endif /* _OPENMP */
                                                              for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_33; __pyx_t_15++){
                                                                  {
                                                                      __pyx_v_i = (short)(0 + 1 * __pyx_t_15);
                                                                      /* Initialize private variables to invalid values */
                                                                      __pyx_v_glcm_val = ((float)__PYX_NAN());
                                                                      __pyx_v_j = ((short)0xbad0bad0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">138</span>:                     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">glcm_max_value</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                                                                      __pyx_t_34 = __pyx_v_glcm_max_value;
                                                                      if ((1 == 0)) abort();
                                                                      {
                                                                          __pyx_t_36 = (__pyx_t_34 - 0 + 1 - 1/abs(1)) / 1;
                                                                          if (__pyx_t_36 &gt; 0)
                                                                          {
                                                                              #if 0
                                                                              #pragma omp parallel
                                                                              #endif /* _OPENMP */
                                                                              {
                                                                                  #if 0
                                                                                  #pragma omp for lastprivate(__pyx_v_glcm_val) firstprivate(__pyx_v_j) lastprivate(__pyx_v_j) schedule(dynamic)
                                                                                  #endif /* _OPENMP */
                                                                                  for (__pyx_t_35 = 0; __pyx_t_35 &lt; __pyx_t_36; __pyx_t_35++){
                                                                                      {
                                                                                          __pyx_v_j = (short)(0 + 1 * __pyx_t_35);
                                                                                          /* Initialize private variables to invalid values */
                                                                                          __pyx_v_glcm_val = ((float)__PYX_NAN());
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">139</span>:                         <span class="n">glcm_val</span> <span class="o">=</span> <span class="n">glcm_v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span> <span class="o">/</span> <span class="n">glcm_max_value</span></pre>
<pre class='cython code score-18 '>                                                                                          __pyx_t_28 = __pyx_v_i;
                                                                                          __pyx_t_29 = __pyx_v_j;
                                                                                          __pyx_t_30 = __pyx_v_wi_r;
                                                                                          __pyx_t_31 = __pyx_v_wi_c;
                                                                                          __pyx_t_32 = __pyx_v_ch;
                                                                                          __pyx_t_37 = (*((unsigned char *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_glcm_v.data + __pyx_t_28 * __pyx_v_glcm_v.strides[0]) ) + __pyx_t_29 * __pyx_v_glcm_v.strides[1]) ) + __pyx_t_30 * __pyx_v_glcm_v.strides[2]) ) + __pyx_t_31 * __pyx_v_glcm_v.strides[3]) ) + __pyx_t_32 * __pyx_v_glcm_v.strides[4]) )));
                                                                                          if (unlikely(__pyx_v_glcm_max_value == 0)) {
                                                                                            #ifdef WITH_THREAD
                                                                                            PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                            #endif
                                                                                            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
                                                                                            #ifdef WITH_THREAD
                                                                                            <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                            #endif
                                                                                            <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L55_error)</span>
                                                                                          }
                                                                                          else if (sizeof(int) == sizeof(long) &amp;&amp; (!(((char)-1) &gt; 0)) &amp;&amp; unlikely(__pyx_v_glcm_max_value == (char)-1)  &amp;&amp; unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_t_37))) {
                                                                                            #ifdef WITH_THREAD
                                                                                            PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                            #endif
                                                                                            <span class='py_c_api'>PyErr_SetString</span>(PyExc_OverflowError, "value too large to perform division");
                                                                                            #ifdef WITH_THREAD
                                                                                            <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                            #endif
                                                                                            <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L55_error)</span>
                                                                                          }
                                                                                          __pyx_v_glcm_val = __Pyx_div_int(__pyx_t_37, __pyx_v_glcm_max_value);
</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">140</span>:                         <span class="k">if</span> <span class="n">glcm_val</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-64 '>                                                                                          __pyx_t_38 = ((__pyx_v_glcm_val != 0.0) != 0);
                                                                                          if (__pyx_t_38) {
/* … */
                                                                                          }
                                                                                          goto __pyx_L59;
                                                                                          __pyx_L55_error:;
                                                                                          {
                                                                                              #ifdef WITH_THREAD
                                                                                              PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                              #endif
                                                                                              #ifdef _OPENMP
                                                                                              #pragma omp flush(__pyx_parallel_exc_type)
                                                                                              #endif /* _OPENMP */
                                                                                              if (!__pyx_parallel_exc_type) {
                                                                                                <span class='pyx_c_api'>__Pyx_ErrFetchWithState</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                                                                                __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                                                                                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                                                                              }
                                                                                              #ifdef WITH_THREAD
                                                                                              <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                              #endif
                                                                                          }
                                                                                          __pyx_parallel_why = 4;
                                                                                          goto __pyx_L58;
                                                                                          __pyx_L58:;
                                                                                          #ifdef _OPENMP
                                                                                          #pragma omp critical(__pyx_parallel_lastprivates0)
                                                                                          #endif /* _OPENMP */
                                                                                          {
                                                                                              __pyx_parallel_temp0 = __pyx_v_glcm_val;
                                                                                              __pyx_parallel_temp1 = __pyx_v_j;
                                                                                          }
                                                                                          __pyx_L59:;
                                                                                          #ifdef _OPENMP
                                                                                          #pragma omp flush(__pyx_parallel_why)
                                                                                          #endif /* _OPENMP */
                                                                                      }
                                                                                  }
                                                                                  #ifdef _OPENMP
                                                                                  Py_END_ALLOW_THREADS
                                                                                  #else
{
#ifdef WITH_THREAD
                                                                                  PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                  #endif
                                                                                  #endif /* _OPENMP */
                                                                                  #ifdef WITH_THREAD
                                                                                  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                  #endif
                                                                                  #ifndef _OPENMP
}
#endif /* _OPENMP */
                                                                              }
                                                                          }
                                                                          if (__pyx_parallel_exc_type) {
                                                                            /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
                                                                            __pyx_parallel_why = 4;
                                                                          }
                                                                          if (__pyx_parallel_why) {
                                                                            __pyx_v_glcm_val = __pyx_parallel_temp0;
                                                                            __pyx_v_j = __pyx_parallel_temp1;
                                                                            switch (__pyx_parallel_why) {
                                                                                  case 4:
                                                                              {
                                                                                  #ifdef WITH_THREAD
                                                                                  PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                  #endif
                                                                                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                                                                                  <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                                                                                  __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                                                                                  #ifdef WITH_THREAD
                                                                                  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                  #endif
                                                                              }
                                                                              goto __pyx_L51_error;
                                                                            }
                                                                          }
                                                                      }
                                                                      goto __pyx_L61;
                                                                      __pyx_L51_error:;
                                                                      {
                                                                          #ifdef WITH_THREAD
                                                                          PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                          #endif
                                                                          #ifdef _OPENMP
                                                                          #pragma omp flush(__pyx_parallel_exc_type)
                                                                          #endif /* _OPENMP */
                                                                          if (!__pyx_parallel_exc_type) {
                                                                            <span class='pyx_c_api'>__Pyx_ErrFetchWithState</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                                                            __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                                                            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                                                          }
                                                                          #ifdef WITH_THREAD
                                                                          <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                          #endif
                                                                      }
                                                                      __pyx_parallel_why = 4;
                                                                      goto __pyx_L60;
                                                                      __pyx_L60:;
                                                                      #ifdef _OPENMP
                                                                      #pragma omp critical(__pyx_parallel_lastprivates1)
                                                                      #endif /* _OPENMP */
                                                                      {
                                                                          __pyx_parallel_temp0 = __pyx_v_glcm_val;
                                                                          __pyx_parallel_temp1 = __pyx_v_i;
                                                                          __pyx_parallel_temp2 = __pyx_v_j;
                                                                      }
                                                                      __pyx_L61:;
                                                                      #ifdef _OPENMP
                                                                      #pragma omp flush(__pyx_parallel_why)
                                                                      #endif /* _OPENMP */
                                                                  }
                                                              }
                                                              #ifdef _OPENMP
                                                              Py_END_ALLOW_THREADS
                                                              #else
{
#ifdef WITH_THREAD
                                                              PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                              #endif
                                                              #endif /* _OPENMP */
                                                              #ifdef WITH_THREAD
                                                              <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                              #endif
                                                              #ifndef _OPENMP
}
#endif /* _OPENMP */
                                                          }
                                                      }
                                                      if (__pyx_parallel_exc_type) {
                                                        /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
                                                        __pyx_parallel_why = 4;
                                                      }
                                                      if (__pyx_parallel_why) {
                                                        __pyx_v_glcm_val = __pyx_parallel_temp0;
                                                        __pyx_v_i = __pyx_parallel_temp1;
                                                        __pyx_v_j = __pyx_parallel_temp2;
                                                        switch (__pyx_parallel_why) {
                                                              case 4:
                                                          {
                                                              #ifdef WITH_THREAD
                                                              PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                              #endif
                                                              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                                                              <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                                                              __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                                                              #ifdef WITH_THREAD
                                                              <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                              #endif
                                                          }
                                                          goto __pyx_L47_error;
                                                        }
                                                      }
                                                  }
                                                  goto __pyx_L63;
                                                  __pyx_L47_error:;
                                                  {
                                                      #ifdef WITH_THREAD
                                                      PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                      #endif
                                                      #ifdef _OPENMP
                                                      #pragma omp flush(__pyx_parallel_exc_type)
                                                      #endif /* _OPENMP */
                                                      if (!__pyx_parallel_exc_type) {
                                                        <span class='pyx_c_api'>__Pyx_ErrFetchWithState</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                                        __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                                      }
                                                      #ifdef WITH_THREAD
                                                      <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                      #endif
                                                  }
                                                  __pyx_parallel_why = 4;
                                                  goto __pyx_L62;
                                                  __pyx_L62:;
                                                  #ifdef _OPENMP
                                                  #pragma omp critical(__pyx_parallel_lastprivates2)
                                                  #endif /* _OPENMP */
                                                  {
                                                      __pyx_parallel_temp0 = __pyx_v_ch;
                                                      __pyx_parallel_temp1 = __pyx_v_glcm_val;
                                                      __pyx_parallel_temp2 = __pyx_v_i;
                                                      __pyx_parallel_temp3 = __pyx_v_j;
                                                  }
                                                  __pyx_L63:;
                                                  #ifdef _OPENMP
                                                  #pragma omp flush(__pyx_parallel_why)
                                                  #endif /* _OPENMP */
                                              }
                                          }
                                          #ifdef _OPENMP
                                          Py_END_ALLOW_THREADS
                                          #else
{
#ifdef WITH_THREAD
                                          PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                          #endif
                                          #endif /* _OPENMP */
                                          #ifdef WITH_THREAD
                                          <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                          #endif
                                          #ifndef _OPENMP
}
#endif /* _OPENMP */
                                      }
                                  }
                                  if (__pyx_parallel_exc_type) {
                                    /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
                                    __pyx_parallel_why = 4;
                                  }
                                  if (__pyx_parallel_why) {
                                    __pyx_v_ch = __pyx_parallel_temp0;
                                    __pyx_v_glcm_val = __pyx_parallel_temp1;
                                    __pyx_v_i = __pyx_parallel_temp2;
                                    __pyx_v_j = __pyx_parallel_temp3;
                                    switch (__pyx_parallel_why) {
                                          case 4:
                                      {
                                          #ifdef WITH_THREAD
                                          PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                          #endif
                                          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                                          <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                                          __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                                          #ifdef WITH_THREAD
                                          <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                          #endif
                                      }
                                      goto __pyx_L43_error;
                                    }
                                  }
                              }
                              goto __pyx_L65;
                              __pyx_L43_error:;
                              {
                                  #ifdef WITH_THREAD
                                  PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                  #endif
                                  #ifdef _OPENMP
                                  #pragma omp flush(__pyx_parallel_exc_type)
                                  #endif /* _OPENMP */
                                  if (!__pyx_parallel_exc_type) {
                                    <span class='pyx_c_api'>__Pyx_ErrFetchWithState</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                    __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                  }
                                  #ifdef WITH_THREAD
                                  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                  #endif
                              }
                              __pyx_parallel_why = 4;
                              goto __pyx_L64;
                              __pyx_L64:;
                              #ifdef _OPENMP
                              #pragma omp critical(__pyx_parallel_lastprivates3)
                              #endif /* _OPENMP */
                              {
                                  __pyx_parallel_temp0 = __pyx_v_ch;
                                  __pyx_parallel_temp1 = __pyx_v_glcm_val;
                                  __pyx_parallel_temp2 = __pyx_v_i;
                                  __pyx_parallel_temp3 = __pyx_v_j;
                                  __pyx_parallel_temp4 = __pyx_v_wi_c;
                              }
                              __pyx_L65:;
                              #ifdef _OPENMP
                              #pragma omp flush(__pyx_parallel_why)
                              #endif /* _OPENMP */
                          }
                      }
                      #ifdef _OPENMP
                      Py_END_ALLOW_THREADS
                      #else
{
#ifdef WITH_THREAD
                      PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                      #endif
                      #endif /* _OPENMP */
                      /* Clean up any temporaries */
                      #ifdef WITH_THREAD
                      <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                      #endif
                      #ifndef _OPENMP
}
#endif /* _OPENMP */
                  }
              }
              if (__pyx_parallel_exc_type) {
                /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
                __pyx_parallel_why = 4;
              }
              if (__pyx_parallel_why) {
                __pyx_v_ch = __pyx_parallel_temp0;
                __pyx_v_glcm_val = __pyx_parallel_temp1;
                __pyx_v_i = __pyx_parallel_temp2;
                __pyx_v_j = __pyx_parallel_temp3;
                __pyx_v_wi_c = __pyx_parallel_temp4;
                switch (__pyx_parallel_why) {
                      case 4:
                  {
                      #ifdef WITH_THREAD
                      PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                      #endif
                      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                      <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                      __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                      #ifdef WITH_THREAD
                      <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                      #endif
                  }
                  goto __pyx_L39_error;
                }
              }
          }
          #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
              #undef likely
              #undef unlikely
              #define likely(x)   __builtin_expect(!!(x), 1)
              #define unlikely(x) __builtin_expect(!!(x), 0)
          #endif
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">141</span>:                             <span class="n">contrast_v</span> <span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span> <span class="o">+=</span> <span class="n">glcm_val</span> <span class="o">*</span> <span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                                                                                            __pyx_t_32 = __pyx_v_wi_r;
                                                                                            __pyx_t_31 = __pyx_v_wi_c;
                                                                                            __pyx_t_30 = __pyx_v_ch;
                                                                                            *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_contrast_v.data + __pyx_t_32 * __pyx_v_contrast_v.strides[0]) ) + __pyx_t_31 * __pyx_v_contrast_v.strides[1]) ) + __pyx_t_30 * __pyx_v_contrast_v.strides[2]) )) += (__pyx_v_glcm_val * __Pyx_pow_long(((long)(__pyx_v_i - __pyx_v_j)), 2));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">142</span>:                             <span class="n">asm_v</span>      <span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span> <span class="o">+=</span> <span class="n">glcm_val</span> <span class="o">**</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>                                                                                            __pyx_t_30 = __pyx_v_wi_r;
                                                                                            __pyx_t_31 = __pyx_v_wi_c;
                                                                                            __pyx_t_32 = __pyx_v_ch;
                                                                                            *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_asm_v.data + __pyx_t_30 * __pyx_v_asm_v.strides[0]) ) + __pyx_t_31 * __pyx_v_asm_v.strides[1]) ) + __pyx_t_32 * __pyx_v_asm_v.strides[2]) )) += powf(__pyx_v_glcm_val, 2.0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">143</span>:                             <span class="n">mean_i_v</span>   <span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span> <span class="o">+=</span> <span class="n">glcm_val</span> <span class="o">*</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>                                                                                            __pyx_t_32 = __pyx_v_wi_r;
                                                                                            __pyx_t_31 = __pyx_v_wi_c;
                                                                                            __pyx_t_30 = __pyx_v_ch;
                                                                                            *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_mean_i_v.data + __pyx_t_32 * __pyx_v_mean_i_v.strides[0]) ) + __pyx_t_31 * __pyx_v_mean_i_v.strides[1]) ) + __pyx_t_30 * __pyx_v_mean_i_v.strides[2]) )) += (__pyx_v_glcm_val * __pyx_v_i);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">144</span>:                             <span class="n">mean_j_v</span>   <span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span> <span class="o">+=</span> <span class="n">glcm_val</span> <span class="o">*</span> <span class="n">j</span></pre>
<pre class='cython code score-0 '>                                                                                            __pyx_t_30 = __pyx_v_wi_r;
                                                                                            __pyx_t_31 = __pyx_v_wi_c;
                                                                                            __pyx_t_32 = __pyx_v_ch;
                                                                                            *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_mean_j_v.data + __pyx_t_30 * __pyx_v_mean_j_v.strides[0]) ) + __pyx_t_31 * __pyx_v_mean_j_v.strides[1]) ) + __pyx_t_32 * __pyx_v_mean_j_v.strides[2]) )) += (__pyx_v_glcm_val * __pyx_v_j);
</pre><pre class="cython line score-0">&#xA0;<span class="">145</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">146</span>:     <span class="c"># ------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">147</span>:     <span class="c"># VARIANCE</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">148</span>:     <span class="c"># ------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">149</span>:     <span class="c"># Only VARIANCE is done here.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">150</span>: </pre>
<pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:     <span class="k">for</span> <span class="n">wi_r</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">window_rows</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">,</span></pre>
<pre class='cython code score-84 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_tqdm);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_rows);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_11);
  __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((!(__pyx_v_verbose != 0)));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_disable, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_desc, __pyx_kp_s_GLCM_Variance_Pass) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_7, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
    __pyx_t_11 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_2 = 0;
    __pyx_t_14 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_11 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_14 = Py_TYPE(__pyx_t_11)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  for (;;) {
    if (likely(!__pyx_t_14)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_11))) {
        if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_11)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_11, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_11, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_11)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_11, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_11, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_14(__pyx_t_11);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    __pyx_t_33 = <span class='pyx_c_api'>__Pyx_PyInt_As_short</span>(__pyx_t_4); if (unlikely((__pyx_t_33 == (short)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_wi_r = __pyx_t_33;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">152</span>:                      <span class="n">desc</span><span class="o">=</span><span class="s">&quot;GLCM Variance Pass&quot;</span><span class="p">):</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">153</span>:         <span class="k">for</span> <span class="n">wi_c</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">window_cols</span><span class="p">,</span> <span class="k">nogil</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-6 '>    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
        #endif
        /*try:*/ {
          __pyx_t_16 = __pyx_v_window_cols;
          if ((1 == 0)) abort();
          {
              #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                  #undef likely
                  #undef unlikely
                  #define likely(x)   (x)
                  #define unlikely(x) (x)
              #endif
              __pyx_t_18 = (__pyx_t_16 - 0 + 1 - 1/abs(1)) / 1;
              if (__pyx_t_18 &gt; 0)
              {
                  #ifdef _OPENMP
                  #pragma omp parallel
                  #endif /* _OPENMP */
                  {
                      #ifdef _OPENMP
                      #pragma omp for lastprivate(__pyx_v_ch) lastprivate(__pyx_v_glcm_val) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) lastprivate(__pyx_v_mean_i_val) lastprivate(__pyx_v_mean_j_val) firstprivate(__pyx_v_wi_c) lastprivate(__pyx_v_wi_c) schedule(dynamic)
                      #endif /* _OPENMP */
                      for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_18; __pyx_t_17++){
                          {
                              __pyx_v_wi_c = (short)(0 + 1 * __pyx_t_17);
                              /* Initialize private variables to invalid values */
                              __pyx_v_ch = ((char)'?');
                              __pyx_v_glcm_val = ((float)__PYX_NAN());
                              __pyx_v_i = ((short)0xbad0bad0);
                              __pyx_v_j = ((short)0xbad0bad0);
                              __pyx_v_mean_i_val = ((float)__PYX_NAN());
                              __pyx_v_mean_j_val = ((float)__PYX_NAN());
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L72;
          }
          __pyx_L71_error: {
            #ifdef WITH_THREAD
            <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L1_error;
          }
          __pyx_L72:;
        }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">154</span>:             <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_19 = __pyx_v_channels;
                              if ((1 == 0)) abort();
                              {
                                  __pyx_t_21 = (__pyx_t_19 - 0 + 1 - 1/abs(1)) / 1;
                                  if (__pyx_t_21 &gt; 0)
                                  {
                                      #if 0
                                      #pragma omp parallel
                                      #endif /* _OPENMP */
                                      {
                                          #if 0
                                          #pragma omp for firstprivate(__pyx_v_ch) lastprivate(__pyx_v_ch) lastprivate(__pyx_v_glcm_val) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) lastprivate(__pyx_v_mean_i_val) lastprivate(__pyx_v_mean_j_val) schedule(dynamic)
                                          #endif /* _OPENMP */
                                          for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_21; __pyx_t_20++){
                                              {
                                                  __pyx_v_ch = (char)(0 + 1 * __pyx_t_20);
                                                  /* Initialize private variables to invalid values */
                                                  __pyx_v_glcm_val = ((float)__PYX_NAN());
                                                  __pyx_v_i = ((short)0xbad0bad0);
                                                  __pyx_v_j = ((short)0xbad0bad0);
                                                  __pyx_v_mean_i_val = ((float)__PYX_NAN());
                                                  __pyx_v_mean_j_val = ((float)__PYX_NAN());
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">155</span>:                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">glcm_max_value</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                                                  __pyx_t_8 = __pyx_v_glcm_max_value;
                                                  if ((1 == 0)) abort();
                                                  {
                                                      __pyx_t_15 = (__pyx_t_8 - 0 + 1 - 1/abs(1)) / 1;
                                                      if (__pyx_t_15 &gt; 0)
                                                      {
                                                          #if 0
                                                          #pragma omp parallel
                                                          #endif /* _OPENMP */
                                                          {
                                                              #if 0
                                                              #pragma omp for lastprivate(__pyx_v_glcm_val) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) lastprivate(__pyx_v_mean_i_val) lastprivate(__pyx_v_mean_j_val) schedule(dynamic)
                                                              #endif /* _OPENMP */
                                                              for (__pyx_t_33 = 0; __pyx_t_33 &lt; __pyx_t_15; __pyx_t_33++){
                                                                  {
                                                                      __pyx_v_i = (short)(0 + 1 * __pyx_t_33);
                                                                      /* Initialize private variables to invalid values */
                                                                      __pyx_v_glcm_val = ((float)__PYX_NAN());
                                                                      __pyx_v_j = ((short)0xbad0bad0);
                                                                      __pyx_v_mean_i_val = ((float)__PYX_NAN());
                                                                      __pyx_v_mean_j_val = ((float)__PYX_NAN());
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">156</span>:                     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">glcm_max_value</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                                                                      __pyx_t_34 = __pyx_v_glcm_max_value;
                                                                      if ((1 == 0)) abort();
                                                                      {
                                                                          __pyx_t_35 = (__pyx_t_34 - 0 + 1 - 1/abs(1)) / 1;
                                                                          if (__pyx_t_35 &gt; 0)
                                                                          {
                                                                              #if 0
                                                                              #pragma omp parallel
                                                                              #endif /* _OPENMP */
                                                                              {
                                                                                  #if 0
                                                                                  #pragma omp for lastprivate(__pyx_v_glcm_val) firstprivate(__pyx_v_j) lastprivate(__pyx_v_j) lastprivate(__pyx_v_mean_i_val) lastprivate(__pyx_v_mean_j_val) schedule(dynamic)
                                                                                  #endif /* _OPENMP */
                                                                                  for (__pyx_t_36 = 0; __pyx_t_36 &lt; __pyx_t_35; __pyx_t_36++){
                                                                                      {
                                                                                          __pyx_v_j = (short)(0 + 1 * __pyx_t_36);
                                                                                          /* Initialize private variables to invalid values */
                                                                                          __pyx_v_glcm_val = ((float)__PYX_NAN());
                                                                                          __pyx_v_mean_i_val = ((float)__PYX_NAN());
                                                                                          __pyx_v_mean_j_val = ((float)__PYX_NAN());
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">157</span>:                         <span class="n">glcm_val</span> <span class="o">=</span> <span class="n">glcm_v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span> <span class="o">/</span> <span class="n">glcm_max_value</span></pre>
<pre class='cython code score-18 '>                                                                                          __pyx_t_32 = __pyx_v_i;
                                                                                          __pyx_t_31 = __pyx_v_j;
                                                                                          __pyx_t_30 = __pyx_v_wi_r;
                                                                                          __pyx_t_29 = __pyx_v_wi_c;
                                                                                          __pyx_t_28 = __pyx_v_ch;
                                                                                          __pyx_t_37 = (*((unsigned char *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_glcm_v.data + __pyx_t_32 * __pyx_v_glcm_v.strides[0]) ) + __pyx_t_31 * __pyx_v_glcm_v.strides[1]) ) + __pyx_t_30 * __pyx_v_glcm_v.strides[2]) ) + __pyx_t_29 * __pyx_v_glcm_v.strides[3]) ) + __pyx_t_28 * __pyx_v_glcm_v.strides[4]) )));
                                                                                          if (unlikely(__pyx_v_glcm_max_value == 0)) {
                                                                                            #ifdef WITH_THREAD
                                                                                            PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                            #endif
                                                                                            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
                                                                                            #ifdef WITH_THREAD
                                                                                            <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                            #endif
                                                                                            <span class='error_goto'>__PYX_ERR(0, 157, __pyx_L87_error)</span>
                                                                                          }
                                                                                          else if (sizeof(int) == sizeof(long) &amp;&amp; (!(((char)-1) &gt; 0)) &amp;&amp; unlikely(__pyx_v_glcm_max_value == (char)-1)  &amp;&amp; unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_t_37))) {
                                                                                            #ifdef WITH_THREAD
                                                                                            PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                            #endif
                                                                                            <span class='py_c_api'>PyErr_SetString</span>(PyExc_OverflowError, "value too large to perform division");
                                                                                            #ifdef WITH_THREAD
                                                                                            <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                            #endif
                                                                                            <span class='error_goto'>__PYX_ERR(0, 157, __pyx_L87_error)</span>
                                                                                          }
                                                                                          __pyx_v_glcm_val = __Pyx_div_int(__pyx_t_37, __pyx_v_glcm_max_value);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">158</span>:                         <span class="n">mean_i_val</span> <span class="o">=</span> <span class="n">mean_i_v</span><span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                                                                          __pyx_t_28 = __pyx_v_wi_r;
                                                                                          __pyx_t_29 = __pyx_v_wi_c;
                                                                                          __pyx_t_30 = __pyx_v_ch;
                                                                                          __pyx_v_mean_i_val = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_mean_i_v.data + __pyx_t_28 * __pyx_v_mean_i_v.strides[0]) ) + __pyx_t_29 * __pyx_v_mean_i_v.strides[1]) ) + __pyx_t_30 * __pyx_v_mean_i_v.strides[2]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">159</span>:                         <span class="n">mean_j_val</span> <span class="o">=</span> <span class="n">mean_j_v</span><span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                                                                          __pyx_t_30 = __pyx_v_wi_r;
                                                                                          __pyx_t_29 = __pyx_v_wi_c;
                                                                                          __pyx_t_28 = __pyx_v_ch;
                                                                                          __pyx_v_mean_j_val = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_mean_j_v.data + __pyx_t_30 * __pyx_v_mean_j_v.strides[0]) ) + __pyx_t_29 * __pyx_v_mean_j_v.strides[1]) ) + __pyx_t_28 * __pyx_v_mean_j_v.strides[2]) )));
</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">160</span>:                         <span class="k">if</span> <span class="n">glcm_val</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-64 '>                                                                                          __pyx_t_38 = ((__pyx_v_glcm_val != 0.0) != 0);
                                                                                          if (__pyx_t_38) {
/* … */
                                                                                          }
                                                                                          goto __pyx_L91;
                                                                                          __pyx_L87_error:;
                                                                                          {
                                                                                              #ifdef WITH_THREAD
                                                                                              PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                              #endif
                                                                                              #ifdef _OPENMP
                                                                                              #pragma omp flush(__pyx_parallel_exc_type)
                                                                                              #endif /* _OPENMP */
                                                                                              if (!__pyx_parallel_exc_type) {
                                                                                                <span class='pyx_c_api'>__Pyx_ErrFetchWithState</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                                                                                __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                                                                                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                                                                              }
                                                                                              #ifdef WITH_THREAD
                                                                                              <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                              #endif
                                                                                          }
                                                                                          __pyx_parallel_why = 4;
                                                                                          goto __pyx_L90;
                                                                                          __pyx_L90:;
                                                                                          #ifdef _OPENMP
                                                                                          #pragma omp critical(__pyx_parallel_lastprivates4)
                                                                                          #endif /* _OPENMP */
                                                                                          {
                                                                                              __pyx_parallel_temp0 = __pyx_v_glcm_val;
                                                                                              __pyx_parallel_temp1 = __pyx_v_j;
                                                                                              __pyx_parallel_temp2 = __pyx_v_mean_i_val;
                                                                                              __pyx_parallel_temp3 = __pyx_v_mean_j_val;
                                                                                          }
                                                                                          __pyx_L91:;
                                                                                          #ifdef _OPENMP
                                                                                          #pragma omp flush(__pyx_parallel_why)
                                                                                          #endif /* _OPENMP */
                                                                                      }
                                                                                  }
                                                                                  #ifdef _OPENMP
                                                                                  Py_END_ALLOW_THREADS
                                                                                  #else
{
#ifdef WITH_THREAD
                                                                                  PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                  #endif
                                                                                  #endif /* _OPENMP */
                                                                                  #ifdef WITH_THREAD
                                                                                  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                  #endif
                                                                                  #ifndef _OPENMP
}
#endif /* _OPENMP */
                                                                              }
                                                                          }
                                                                          if (__pyx_parallel_exc_type) {
                                                                            /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
                                                                            __pyx_parallel_why = 4;
                                                                          }
                                                                          if (__pyx_parallel_why) {
                                                                            __pyx_v_glcm_val = __pyx_parallel_temp0;
                                                                            __pyx_v_j = __pyx_parallel_temp1;
                                                                            __pyx_v_mean_i_val = __pyx_parallel_temp2;
                                                                            __pyx_v_mean_j_val = __pyx_parallel_temp3;
                                                                            switch (__pyx_parallel_why) {
                                                                                  case 4:
                                                                              {
                                                                                  #ifdef WITH_THREAD
                                                                                  PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                  #endif
                                                                                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                                                                                  <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                                                                                  __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                                                                                  #ifdef WITH_THREAD
                                                                                  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                  #endif
                                                                              }
                                                                              goto __pyx_L83_error;
                                                                            }
                                                                          }
                                                                      }
                                                                      goto __pyx_L93;
                                                                      __pyx_L83_error:;
                                                                      {
                                                                          #ifdef WITH_THREAD
                                                                          PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                          #endif
                                                                          #ifdef _OPENMP
                                                                          #pragma omp flush(__pyx_parallel_exc_type)
                                                                          #endif /* _OPENMP */
                                                                          if (!__pyx_parallel_exc_type) {
                                                                            <span class='pyx_c_api'>__Pyx_ErrFetchWithState</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                                                            __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                                                            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                                                          }
                                                                          #ifdef WITH_THREAD
                                                                          <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                          #endif
                                                                      }
                                                                      __pyx_parallel_why = 4;
                                                                      goto __pyx_L92;
                                                                      __pyx_L92:;
                                                                      #ifdef _OPENMP
                                                                      #pragma omp critical(__pyx_parallel_lastprivates5)
                                                                      #endif /* _OPENMP */
                                                                      {
                                                                          __pyx_parallel_temp0 = __pyx_v_glcm_val;
                                                                          __pyx_parallel_temp1 = __pyx_v_i;
                                                                          __pyx_parallel_temp2 = __pyx_v_j;
                                                                          __pyx_parallel_temp3 = __pyx_v_mean_i_val;
                                                                          __pyx_parallel_temp4 = __pyx_v_mean_j_val;
                                                                      }
                                                                      __pyx_L93:;
                                                                      #ifdef _OPENMP
                                                                      #pragma omp flush(__pyx_parallel_why)
                                                                      #endif /* _OPENMP */
                                                                  }
                                                              }
                                                              #ifdef _OPENMP
                                                              Py_END_ALLOW_THREADS
                                                              #else
{
#ifdef WITH_THREAD
                                                              PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                              #endif
                                                              #endif /* _OPENMP */
                                                              #ifdef WITH_THREAD
                                                              <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                              #endif
                                                              #ifndef _OPENMP
}
#endif /* _OPENMP */
                                                          }
                                                      }
                                                      if (__pyx_parallel_exc_type) {
                                                        /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
                                                        __pyx_parallel_why = 4;
                                                      }
                                                      if (__pyx_parallel_why) {
                                                        __pyx_v_glcm_val = __pyx_parallel_temp0;
                                                        __pyx_v_i = __pyx_parallel_temp1;
                                                        __pyx_v_j = __pyx_parallel_temp2;
                                                        __pyx_v_mean_i_val = __pyx_parallel_temp3;
                                                        __pyx_v_mean_j_val = __pyx_parallel_temp4;
                                                        switch (__pyx_parallel_why) {
                                                              case 4:
                                                          {
                                                              #ifdef WITH_THREAD
                                                              PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                              #endif
                                                              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                                                              <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                                                              __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                                                              #ifdef WITH_THREAD
                                                              <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                              #endif
                                                          }
                                                          goto __pyx_L79_error;
                                                        }
                                                      }
                                                  }
                                                  goto __pyx_L95;
                                                  __pyx_L79_error:;
                                                  {
                                                      #ifdef WITH_THREAD
                                                      PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                      #endif
                                                      #ifdef _OPENMP
                                                      #pragma omp flush(__pyx_parallel_exc_type)
                                                      #endif /* _OPENMP */
                                                      if (!__pyx_parallel_exc_type) {
                                                        <span class='pyx_c_api'>__Pyx_ErrFetchWithState</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                                        __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                                      }
                                                      #ifdef WITH_THREAD
                                                      <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                      #endif
                                                  }
                                                  __pyx_parallel_why = 4;
                                                  goto __pyx_L94;
                                                  __pyx_L94:;
                                                  #ifdef _OPENMP
                                                  #pragma omp critical(__pyx_parallel_lastprivates6)
                                                  #endif /* _OPENMP */
                                                  {
                                                      __pyx_parallel_temp0 = __pyx_v_ch;
                                                      __pyx_parallel_temp1 = __pyx_v_glcm_val;
                                                      __pyx_parallel_temp2 = __pyx_v_i;
                                                      __pyx_parallel_temp3 = __pyx_v_j;
                                                      __pyx_parallel_temp4 = __pyx_v_mean_i_val;
                                                      __pyx_parallel_temp5 = __pyx_v_mean_j_val;
                                                  }
                                                  __pyx_L95:;
                                                  #ifdef _OPENMP
                                                  #pragma omp flush(__pyx_parallel_why)
                                                  #endif /* _OPENMP */
                                              }
                                          }
                                          #ifdef _OPENMP
                                          Py_END_ALLOW_THREADS
                                          #else
{
#ifdef WITH_THREAD
                                          PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                          #endif
                                          #endif /* _OPENMP */
                                          #ifdef WITH_THREAD
                                          <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                          #endif
                                          #ifndef _OPENMP
}
#endif /* _OPENMP */
                                      }
                                  }
                                  if (__pyx_parallel_exc_type) {
                                    /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
                                    __pyx_parallel_why = 4;
                                  }
                                  if (__pyx_parallel_why) {
                                    __pyx_v_ch = __pyx_parallel_temp0;
                                    __pyx_v_glcm_val = __pyx_parallel_temp1;
                                    __pyx_v_i = __pyx_parallel_temp2;
                                    __pyx_v_j = __pyx_parallel_temp3;
                                    __pyx_v_mean_i_val = __pyx_parallel_temp4;
                                    __pyx_v_mean_j_val = __pyx_parallel_temp5;
                                    switch (__pyx_parallel_why) {
                                          case 4:
                                      {
                                          #ifdef WITH_THREAD
                                          PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                          #endif
                                          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                                          <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                                          __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                                          #ifdef WITH_THREAD
                                          <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                          #endif
                                      }
                                      goto __pyx_L75_error;
                                    }
                                  }
                              }
                              goto __pyx_L97;
                              __pyx_L75_error:;
                              {
                                  #ifdef WITH_THREAD
                                  PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                  #endif
                                  #ifdef _OPENMP
                                  #pragma omp flush(__pyx_parallel_exc_type)
                                  #endif /* _OPENMP */
                                  if (!__pyx_parallel_exc_type) {
                                    <span class='pyx_c_api'>__Pyx_ErrFetchWithState</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                    __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                  }
                                  #ifdef WITH_THREAD
                                  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                  #endif
                              }
                              __pyx_parallel_why = 4;
                              goto __pyx_L96;
                              __pyx_L96:;
                              #ifdef _OPENMP
                              #pragma omp critical(__pyx_parallel_lastprivates7)
                              #endif /* _OPENMP */
                              {
                                  __pyx_parallel_temp0 = __pyx_v_ch;
                                  __pyx_parallel_temp1 = __pyx_v_glcm_val;
                                  __pyx_parallel_temp2 = __pyx_v_i;
                                  __pyx_parallel_temp3 = __pyx_v_j;
                                  __pyx_parallel_temp4 = __pyx_v_mean_i_val;
                                  __pyx_parallel_temp5 = __pyx_v_mean_j_val;
                                  __pyx_parallel_temp6 = __pyx_v_wi_c;
                              }
                              __pyx_L97:;
                              #ifdef _OPENMP
                              #pragma omp flush(__pyx_parallel_why)
                              #endif /* _OPENMP */
                          }
                      }
                      #ifdef _OPENMP
                      Py_END_ALLOW_THREADS
                      #else
{
#ifdef WITH_THREAD
                      PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                      #endif
                      #endif /* _OPENMP */
                      /* Clean up any temporaries */
                      #ifdef WITH_THREAD
                      <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                      #endif
                      #ifndef _OPENMP
}
#endif /* _OPENMP */
                  }
              }
              if (__pyx_parallel_exc_type) {
                /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
                __pyx_parallel_why = 4;
              }
              if (__pyx_parallel_why) {
                __pyx_v_ch = __pyx_parallel_temp0;
                __pyx_v_glcm_val = __pyx_parallel_temp1;
                __pyx_v_i = __pyx_parallel_temp2;
                __pyx_v_j = __pyx_parallel_temp3;
                __pyx_v_mean_i_val = __pyx_parallel_temp4;
                __pyx_v_mean_j_val = __pyx_parallel_temp5;
                __pyx_v_wi_c = __pyx_parallel_temp6;
                switch (__pyx_parallel_why) {
                      case 4:
                  {
                      #ifdef WITH_THREAD
                      PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                      #endif
                      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                      <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                      __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                      #ifdef WITH_THREAD
                      <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                      #endif
                  }
                  goto __pyx_L71_error;
                }
              }
          }
          #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
              #undef likely
              #undef unlikely
              #define likely(x)   __builtin_expect(!!(x), 1)
              #define unlikely(x) __builtin_expect(!!(x), 0)
          #endif
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">161</span>:                             <span class="n">var_i_v</span><span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span> <span class="o">+=</span> <span class="n">glcm_val</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">mean_i_val</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>                                                                                            __pyx_t_28 = __pyx_v_wi_r;
                                                                                            __pyx_t_29 = __pyx_v_wi_c;
                                                                                            __pyx_t_30 = __pyx_v_ch;
                                                                                            *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_var_i_v.data + __pyx_t_28 * __pyx_v_var_i_v.strides[0]) ) + __pyx_t_29 * __pyx_v_var_i_v.strides[1]) ) + __pyx_t_30 * __pyx_v_var_i_v.strides[2]) )) += (__pyx_v_glcm_val * powf((__pyx_v_i - __pyx_v_mean_i_val), 2.0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">162</span>:                             <span class="n">var_j_v</span><span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span> <span class="o">+=</span> <span class="n">glcm_val</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">mean_j_val</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>                                                                                            __pyx_t_30 = __pyx_v_wi_r;
                                                                                            __pyx_t_29 = __pyx_v_wi_c;
                                                                                            __pyx_t_28 = __pyx_v_ch;
                                                                                            *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_var_j_v.data + __pyx_t_30 * __pyx_v_var_j_v.strides[0]) ) + __pyx_t_29 * __pyx_v_var_j_v.strides[1]) ) + __pyx_t_28 * __pyx_v_var_j_v.strides[2]) )) += (__pyx_v_glcm_val * powf((__pyx_v_j - __pyx_v_mean_j_val), 2.0));
</pre><pre class="cython line score-0">&#xA0;<span class="">163</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">164</span>:     <span class="c"># ---------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">165</span>:     <span class="c"># CORRELATION, MEAN, VARIANCE</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">166</span>:     <span class="c"># ---------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">167</span>:     <span class="c"># Mean and Variance are also features we want, so we just merge them by averaging</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>: </pre>
<pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">169</span>:     <span class="k">for</span> <span class="n">wi_r</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">window_rows</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">,</span></pre>
<pre class='cython code score-84 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_tqdm);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_short</span>(__pyx_v_window_rows);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((!(__pyx_v_verbose != 0)));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_disable, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_desc, __pyx_kp_s_GLCM_Correlation_Mean_Variance_M) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_4, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_9)) {
    __pyx_t_7 = __pyx_t_9; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_2 = 0;
    __pyx_t_14 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_14 = Py_TYPE(__pyx_t_7)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  for (;;) {
    if (likely(!__pyx_t_14)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7))) {
        if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_7)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_7, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_2++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>
        #else
        __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_7, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        #endif
      } else {
        if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_7)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_7, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_2++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>
        #else
        __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_7, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        #endif
      }
    } else {
      __pyx_t_9 = __pyx_t_14(__pyx_t_7);
      if (unlikely(!__pyx_t_9)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    }
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyInt_As_short</span>(__pyx_t_9); if (unlikely((__pyx_t_15 == (short)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_v_wi_r = __pyx_t_15;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">170</span>:                      <span class="n">desc</span><span class="o">=</span><span class="s">&quot;GLCM Correlation, Mean, Variance Merge Pass&quot;</span><span class="p">):</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">171</span>:         <span class="k">for</span> <span class="n">wi_c</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">window_cols</span><span class="p">,</span> <span class="k">nogil</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-6 '>    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
        #endif
        /*try:*/ {
          __pyx_t_18 = __pyx_v_window_cols;
          if ((1 == 0)) abort();
          {
              #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                  #undef likely
                  #undef unlikely
                  #define likely(x)   (x)
                  #define unlikely(x) (x)
              #endif
              __pyx_t_16 = (__pyx_t_18 - 0 + 1 - 1/abs(1)) / 1;
              if (__pyx_t_16 &gt; 0)
              {
                  #ifdef _OPENMP
                  #pragma omp parallel
                  #endif /* _OPENMP */
                  {
                      #ifdef _OPENMP
                      #pragma omp for lastprivate(__pyx_v_ch) lastprivate(__pyx_v_glcm_val) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) lastprivate(__pyx_v_mean_i_val) lastprivate(__pyx_v_mean_j_val) lastprivate(__pyx_v_var_i_val) lastprivate(__pyx_v_var_j_val) firstprivate(__pyx_v_wi_c) lastprivate(__pyx_v_wi_c) schedule(dynamic)
                      #endif /* _OPENMP */
                      for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17++){
                          {
                              __pyx_v_wi_c = (short)(0 + 1 * __pyx_t_17);
                              /* Initialize private variables to invalid values */
                              __pyx_v_ch = ((char)'?');
                              __pyx_v_glcm_val = ((float)__PYX_NAN());
                              __pyx_v_i = ((short)0xbad0bad0);
                              __pyx_v_j = ((short)0xbad0bad0);
                              __pyx_v_mean_i_val = ((float)__PYX_NAN());
                              __pyx_v_mean_j_val = ((float)__PYX_NAN());
                              __pyx_v_var_i_val = ((float)__PYX_NAN());
                              __pyx_v_var_j_val = ((float)__PYX_NAN());
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L104;
          }
          __pyx_L103_error: {
            #ifdef WITH_THREAD
            <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L1_error;
          }
          __pyx_L104:;
        }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">172</span>:             <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span>              <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_21 = __pyx_v_channels;
                              if ((1 == 0)) abort();
                              {
                                  __pyx_t_19 = (__pyx_t_21 - 0 + 1 - 1/abs(1)) / 1;
                                  if (__pyx_t_19 &gt; 0)
                                  {
                                      #if 0
                                      #pragma omp parallel
                                      #endif /* _OPENMP */
                                      {
                                          #if 0
                                          #pragma omp for firstprivate(__pyx_v_ch) lastprivate(__pyx_v_ch) lastprivate(__pyx_v_glcm_val) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) lastprivate(__pyx_v_mean_i_val) lastprivate(__pyx_v_mean_j_val) lastprivate(__pyx_v_var_i_val) lastprivate(__pyx_v_var_j_val) schedule(dynamic)
                                          #endif /* _OPENMP */
                                          for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_19; __pyx_t_20++){
                                              {
                                                  __pyx_v_ch = (char)(0 + 1 * __pyx_t_20);
                                                  /* Initialize private variables to invalid values */
                                                  __pyx_v_glcm_val = ((float)__PYX_NAN());
                                                  __pyx_v_i = ((short)0xbad0bad0);
                                                  __pyx_v_j = ((short)0xbad0bad0);
                                                  __pyx_v_mean_i_val = ((float)__PYX_NAN());
                                                  __pyx_v_mean_j_val = ((float)__PYX_NAN());
                                                  __pyx_v_var_i_val = ((float)__PYX_NAN());
                                                  __pyx_v_var_j_val = ((float)__PYX_NAN());
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">173</span>:                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">glcm_max_value</span><span class="p">,</span>     <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                                                  __pyx_t_8 = __pyx_v_glcm_max_value;
                                                  if ((1 == 0)) abort();
                                                  {
                                                      __pyx_t_33 = (__pyx_t_8 - 0 + 1 - 1/abs(1)) / 1;
                                                      if (__pyx_t_33 &gt; 0)
                                                      {
                                                          #if 0
                                                          #pragma omp parallel
                                                          #endif /* _OPENMP */
                                                          {
                                                              #if 0
                                                              #pragma omp for lastprivate(__pyx_v_glcm_val) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) lastprivate(__pyx_v_mean_i_val) lastprivate(__pyx_v_mean_j_val) lastprivate(__pyx_v_var_i_val) lastprivate(__pyx_v_var_j_val) schedule(dynamic)
                                                              #endif /* _OPENMP */
                                                              for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_33; __pyx_t_15++){
                                                                  {
                                                                      __pyx_v_i = (short)(0 + 1 * __pyx_t_15);
                                                                      /* Initialize private variables to invalid values */
                                                                      __pyx_v_glcm_val = ((float)__PYX_NAN());
                                                                      __pyx_v_j = ((short)0xbad0bad0);
                                                                      __pyx_v_mean_i_val = ((float)__PYX_NAN());
                                                                      __pyx_v_mean_j_val = ((float)__PYX_NAN());
                                                                      __pyx_v_var_i_val = ((float)__PYX_NAN());
                                                                      __pyx_v_var_j_val = ((float)__PYX_NAN());
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">174</span>:                     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">glcm_max_value</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="s">&#39;dynamic&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                                                                      __pyx_t_34 = __pyx_v_glcm_max_value;
                                                                      if ((1 == 0)) abort();
                                                                      {
                                                                          __pyx_t_36 = (__pyx_t_34 - 0 + 1 - 1/abs(1)) / 1;
                                                                          if (__pyx_t_36 &gt; 0)
                                                                          {
                                                                              #if 0
                                                                              #pragma omp parallel
                                                                              #endif /* _OPENMP */
                                                                              {
                                                                                  #if 0
                                                                                  #pragma omp for lastprivate(__pyx_v_glcm_val) firstprivate(__pyx_v_j) lastprivate(__pyx_v_j) lastprivate(__pyx_v_mean_i_val) lastprivate(__pyx_v_mean_j_val) lastprivate(__pyx_v_var_i_val) lastprivate(__pyx_v_var_j_val) schedule(dynamic)
                                                                                  #endif /* _OPENMP */
                                                                                  for (__pyx_t_35 = 0; __pyx_t_35 &lt; __pyx_t_36; __pyx_t_35++){
                                                                                      {
                                                                                          __pyx_v_j = (short)(0 + 1 * __pyx_t_35);
                                                                                          /* Initialize private variables to invalid values */
                                                                                          __pyx_v_glcm_val = ((float)__PYX_NAN());
                                                                                          __pyx_v_mean_i_val = ((float)__PYX_NAN());
                                                                                          __pyx_v_mean_j_val = ((float)__PYX_NAN());
                                                                                          __pyx_v_var_i_val = ((float)__PYX_NAN());
                                                                                          __pyx_v_var_j_val = ((float)__PYX_NAN());
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">175</span>:                         <span class="n">glcm_val</span> <span class="o">=</span> <span class="n">glcm_v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span> <span class="o">/</span> <span class="n">glcm_max_value</span></pre>
<pre class='cython code score-18 '>                                                                                          __pyx_t_28 = __pyx_v_i;
                                                                                          __pyx_t_29 = __pyx_v_j;
                                                                                          __pyx_t_30 = __pyx_v_wi_r;
                                                                                          __pyx_t_31 = __pyx_v_wi_c;
                                                                                          __pyx_t_32 = __pyx_v_ch;
                                                                                          __pyx_t_37 = (*((unsigned char *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_glcm_v.data + __pyx_t_28 * __pyx_v_glcm_v.strides[0]) ) + __pyx_t_29 * __pyx_v_glcm_v.strides[1]) ) + __pyx_t_30 * __pyx_v_glcm_v.strides[2]) ) + __pyx_t_31 * __pyx_v_glcm_v.strides[3]) ) + __pyx_t_32 * __pyx_v_glcm_v.strides[4]) )));
                                                                                          if (unlikely(__pyx_v_glcm_max_value == 0)) {
                                                                                            #ifdef WITH_THREAD
                                                                                            PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                            #endif
                                                                                            <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
                                                                                            #ifdef WITH_THREAD
                                                                                            <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                            #endif
                                                                                            <span class='error_goto'>__PYX_ERR(0, 175, __pyx_L119_error)</span>
                                                                                          }
                                                                                          else if (sizeof(int) == sizeof(long) &amp;&amp; (!(((char)-1) &gt; 0)) &amp;&amp; unlikely(__pyx_v_glcm_max_value == (char)-1)  &amp;&amp; unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_t_37))) {
                                                                                            #ifdef WITH_THREAD
                                                                                            PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                            #endif
                                                                                            <span class='py_c_api'>PyErr_SetString</span>(PyExc_OverflowError, "value too large to perform division");
                                                                                            #ifdef WITH_THREAD
                                                                                            <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                            #endif
                                                                                            <span class='error_goto'>__PYX_ERR(0, 175, __pyx_L119_error)</span>
                                                                                          }
                                                                                          __pyx_v_glcm_val = __Pyx_div_int(__pyx_t_37, __pyx_v_glcm_max_value);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">176</span>:                         <span class="n">mean_i_val</span> <span class="o">=</span> <span class="n">mean_i_v</span><span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                                                                          __pyx_t_32 = __pyx_v_wi_r;
                                                                                          __pyx_t_31 = __pyx_v_wi_c;
                                                                                          __pyx_t_30 = __pyx_v_ch;
                                                                                          __pyx_v_mean_i_val = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_mean_i_v.data + __pyx_t_32 * __pyx_v_mean_i_v.strides[0]) ) + __pyx_t_31 * __pyx_v_mean_i_v.strides[1]) ) + __pyx_t_30 * __pyx_v_mean_i_v.strides[2]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">177</span>:                         <span class="n">mean_j_val</span> <span class="o">=</span> <span class="n">mean_j_v</span><span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                                                                          __pyx_t_30 = __pyx_v_wi_r;
                                                                                          __pyx_t_31 = __pyx_v_wi_c;
                                                                                          __pyx_t_32 = __pyx_v_ch;
                                                                                          __pyx_v_mean_j_val = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_mean_j_v.data + __pyx_t_30 * __pyx_v_mean_j_v.strides[0]) ) + __pyx_t_31 * __pyx_v_mean_j_v.strides[1]) ) + __pyx_t_32 * __pyx_v_mean_j_v.strides[2]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">178</span>:                         <span class="n">var_i_val</span>  <span class="o">=</span> <span class="n">var_i_v</span><span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                                                                          __pyx_t_32 = __pyx_v_wi_r;
                                                                                          __pyx_t_31 = __pyx_v_wi_c;
                                                                                          __pyx_t_30 = __pyx_v_ch;
                                                                                          __pyx_v_var_i_val = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_var_i_v.data + __pyx_t_32 * __pyx_v_var_i_v.strides[0]) ) + __pyx_t_31 * __pyx_v_var_i_v.strides[1]) ) + __pyx_t_30 * __pyx_v_var_i_v.strides[2]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">179</span>:                         <span class="n">var_j_val</span>  <span class="o">=</span> <span class="n">var_j_v</span><span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                                                                          __pyx_t_30 = __pyx_v_wi_r;
                                                                                          __pyx_t_31 = __pyx_v_wi_c;
                                                                                          __pyx_t_32 = __pyx_v_ch;
                                                                                          __pyx_v_var_j_val = (*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_var_j_v.data + __pyx_t_30 * __pyx_v_var_j_v.strides[0]) ) + __pyx_t_31 * __pyx_v_var_j_v.strides[1]) ) + __pyx_t_32 * __pyx_v_var_j_v.strides[2]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">180</span>:                         <span class="k">if</span> <span class="n">glcm_val</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>                                                                                          __pyx_t_38 = ((__pyx_v_glcm_val != 0.0) != 0);
                                                                                          if (__pyx_t_38) {
/* … */
                                                                                          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">181</span>:                             <span class="k">if</span> <span class="n">var_i_val</span> <span class="o">!=</span> <span class="mf">0</span> <span class="ow">and</span> <span class="n">var_j_val</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>                                                                                            __pyx_t_39 = ((__pyx_v_var_i_val != 0.0) != 0);
                                                                                            if (__pyx_t_39) {
                                                                                            } else {
                                                                                              __pyx_t_38 = __pyx_t_39;
                                                                                              goto __pyx_L123_bool_binop_done;
                                                                                            }
                                                                                            __pyx_t_39 = ((__pyx_v_var_j_val != 0.0) != 0);
                                                                                            __pyx_t_38 = __pyx_t_39;
                                                                                            __pyx_L123_bool_binop_done:;
                                                                                            if (__pyx_t_38) {
/* … */
                                                                                            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">182</span>:                                 <span class="n">correlation_v</span><span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span> <span class="o">+=</span> <span class="n">glcm_val</span> <span class="o">*</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>                                                                                              __pyx_t_32 = __pyx_v_wi_r;
                                                                                              __pyx_t_31 = __pyx_v_wi_c;
                                                                                              __pyx_t_30 = __pyx_v_ch;
                                                                                              *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_correlation_v.data + __pyx_t_32 * __pyx_v_correlation_v.strides[0]) ) + __pyx_t_31 * __pyx_v_correlation_v.strides[1]) ) + __pyx_t_30 * __pyx_v_correlation_v.strides[2]) )) += (__pyx_v_glcm_val * (__pyx_t_40 / __pyx_t_41));
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">183</span>:                                     <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">mean_i_val</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">mean_j_val</span><span class="p">)</span> <span class="o">/</span></pre>
<pre class='cython code score-9 '>                                                                                              __pyx_t_40 = ((__pyx_v_i - __pyx_v_mean_i_val) * (__pyx_v_j - __pyx_v_mean_j_val));
/* … */
                                                                                              if (unlikely(__pyx_t_41 == 0)) {
                                                                                                #ifdef WITH_THREAD
                                                                                                PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                                #endif
                                                                                                <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
                                                                                                #ifdef WITH_THREAD
                                                                                                <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                                #endif
                                                                                                <span class='error_goto'>__PYX_ERR(0, 183, __pyx_L119_error)</span>
                                                                                              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">184</span>:                                     <span class="n">sqrt</span><span class="p">(</span><span class="n">var_i_val</span> <span class="o">*</span> <span class="n">var_j_val</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                                                                                              __pyx_t_41 = sqrt((__pyx_v_var_i_val * __pyx_v_var_j_val));
</pre><pre class="cython line score-0">&#xA0;<span class="">185</span>:                                 <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">186</span>:                         <span class="n">mean_v</span><span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean_i_val</span> <span class="o">+</span> <span class="n">mean_j_val</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>                                                                                          __pyx_t_30 = __pyx_v_wi_r;
                                                                                          __pyx_t_31 = __pyx_v_wi_c;
                                                                                          __pyx_t_32 = __pyx_v_ch;
                                                                                          *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_mean_v.data + __pyx_t_30 * __pyx_v_mean_v.strides[0]) ) + __pyx_t_31 * __pyx_v_mean_v.strides[1]) ) + __pyx_t_32 * __pyx_v_mean_v.strides[2]) )) = ((__pyx_v_mean_i_val + __pyx_v_mean_j_val) / 2.0);
</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">187</span>:                         <span class="n">var_v</span><span class="p">[</span><span class="n">wi_r</span><span class="p">,</span> <span class="n">wi_c</span><span class="p">,</span> <span class="n">ch</span><span class="p">]</span>  <span class="o">=</span> <span class="p">(</span><span class="n">var_i_val</span> <span class="o">+</span> <span class="n">var_j_val</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2</span></pre>
<pre class='cython code score-64 '>                                                                                          __pyx_t_32 = __pyx_v_wi_r;
                                                                                          __pyx_t_31 = __pyx_v_wi_c;
                                                                                          __pyx_t_30 = __pyx_v_ch;
                                                                                          *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_var_v.data + __pyx_t_32 * __pyx_v_var_v.strides[0]) ) + __pyx_t_31 * __pyx_v_var_v.strides[1]) ) + __pyx_t_30 * __pyx_v_var_v.strides[2]) )) = ((__pyx_v_var_i_val + __pyx_v_var_j_val) / 2.0);
                                                                                          goto __pyx_L126;
                                                                                          __pyx_L119_error:;
                                                                                          {
                                                                                              #ifdef WITH_THREAD
                                                                                              PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                              #endif
                                                                                              #ifdef _OPENMP
                                                                                              #pragma omp flush(__pyx_parallel_exc_type)
                                                                                              #endif /* _OPENMP */
                                                                                              if (!__pyx_parallel_exc_type) {
                                                                                                <span class='pyx_c_api'>__Pyx_ErrFetchWithState</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                                                                                __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                                                                                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                                                                              }
                                                                                              #ifdef WITH_THREAD
                                                                                              <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                              #endif
                                                                                          }
                                                                                          __pyx_parallel_why = 4;
                                                                                          goto __pyx_L125;
                                                                                          __pyx_L125:;
                                                                                          #ifdef _OPENMP
                                                                                          #pragma omp critical(__pyx_parallel_lastprivates8)
                                                                                          #endif /* _OPENMP */
                                                                                          {
                                                                                              __pyx_parallel_temp0 = __pyx_v_glcm_val;
                                                                                              __pyx_parallel_temp1 = __pyx_v_j;
                                                                                              __pyx_parallel_temp2 = __pyx_v_mean_i_val;
                                                                                              __pyx_parallel_temp3 = __pyx_v_mean_j_val;
                                                                                              __pyx_parallel_temp4 = __pyx_v_var_i_val;
                                                                                              __pyx_parallel_temp5 = __pyx_v_var_j_val;
                                                                                          }
                                                                                          __pyx_L126:;
                                                                                          #ifdef _OPENMP
                                                                                          #pragma omp flush(__pyx_parallel_why)
                                                                                          #endif /* _OPENMP */
                                                                                      }
                                                                                  }
                                                                                  #ifdef _OPENMP
                                                                                  Py_END_ALLOW_THREADS
                                                                                  #else
{
#ifdef WITH_THREAD
                                                                                  PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                  #endif
                                                                                  #endif /* _OPENMP */
                                                                                  #ifdef WITH_THREAD
                                                                                  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                  #endif
                                                                                  #ifndef _OPENMP
}
#endif /* _OPENMP */
                                                                              }
                                                                          }
                                                                          if (__pyx_parallel_exc_type) {
                                                                            /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
                                                                            __pyx_parallel_why = 4;
                                                                          }
                                                                          if (__pyx_parallel_why) {
                                                                            __pyx_v_glcm_val = __pyx_parallel_temp0;
                                                                            __pyx_v_j = __pyx_parallel_temp1;
                                                                            __pyx_v_mean_i_val = __pyx_parallel_temp2;
                                                                            __pyx_v_mean_j_val = __pyx_parallel_temp3;
                                                                            __pyx_v_var_i_val = __pyx_parallel_temp4;
                                                                            __pyx_v_var_j_val = __pyx_parallel_temp5;
                                                                            switch (__pyx_parallel_why) {
                                                                                  case 4:
                                                                              {
                                                                                  #ifdef WITH_THREAD
                                                                                  PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                                  #endif
                                                                                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                                                                                  <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                                                                                  __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                                                                                  #ifdef WITH_THREAD
                                                                                  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                                  #endif
                                                                              }
                                                                              goto __pyx_L115_error;
                                                                            }
                                                                          }
                                                                      }
                                                                      goto __pyx_L128;
                                                                      __pyx_L115_error:;
                                                                      {
                                                                          #ifdef WITH_THREAD
                                                                          PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                                          #endif
                                                                          #ifdef _OPENMP
                                                                          #pragma omp flush(__pyx_parallel_exc_type)
                                                                          #endif /* _OPENMP */
                                                                          if (!__pyx_parallel_exc_type) {
                                                                            <span class='pyx_c_api'>__Pyx_ErrFetchWithState</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                                                            __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                                                            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                                                          }
                                                                          #ifdef WITH_THREAD
                                                                          <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                                          #endif
                                                                      }
                                                                      __pyx_parallel_why = 4;
                                                                      goto __pyx_L127;
                                                                      __pyx_L127:;
                                                                      #ifdef _OPENMP
                                                                      #pragma omp critical(__pyx_parallel_lastprivates9)
                                                                      #endif /* _OPENMP */
                                                                      {
                                                                          __pyx_parallel_temp0 = __pyx_v_glcm_val;
                                                                          __pyx_parallel_temp1 = __pyx_v_i;
                                                                          __pyx_parallel_temp2 = __pyx_v_j;
                                                                          __pyx_parallel_temp3 = __pyx_v_mean_i_val;
                                                                          __pyx_parallel_temp4 = __pyx_v_mean_j_val;
                                                                          __pyx_parallel_temp5 = __pyx_v_var_i_val;
                                                                          __pyx_parallel_temp6 = __pyx_v_var_j_val;
                                                                      }
                                                                      __pyx_L128:;
                                                                      #ifdef _OPENMP
                                                                      #pragma omp flush(__pyx_parallel_why)
                                                                      #endif /* _OPENMP */
                                                                  }
                                                              }
                                                              #ifdef _OPENMP
                                                              Py_END_ALLOW_THREADS
                                                              #else
{
#ifdef WITH_THREAD
                                                              PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                              #endif
                                                              #endif /* _OPENMP */
                                                              #ifdef WITH_THREAD
                                                              <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                              #endif
                                                              #ifndef _OPENMP
}
#endif /* _OPENMP */
                                                          }
                                                      }
                                                      if (__pyx_parallel_exc_type) {
                                                        /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
                                                        __pyx_parallel_why = 4;
                                                      }
                                                      if (__pyx_parallel_why) {
                                                        __pyx_v_glcm_val = __pyx_parallel_temp0;
                                                        __pyx_v_i = __pyx_parallel_temp1;
                                                        __pyx_v_j = __pyx_parallel_temp2;
                                                        __pyx_v_mean_i_val = __pyx_parallel_temp3;
                                                        __pyx_v_mean_j_val = __pyx_parallel_temp4;
                                                        __pyx_v_var_i_val = __pyx_parallel_temp5;
                                                        __pyx_v_var_j_val = __pyx_parallel_temp6;
                                                        switch (__pyx_parallel_why) {
                                                              case 4:
                                                          {
                                                              #ifdef WITH_THREAD
                                                              PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                              #endif
                                                              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                                                              <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                                                              __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                                                              #ifdef WITH_THREAD
                                                              <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                              #endif
                                                          }
                                                          goto __pyx_L111_error;
                                                        }
                                                      }
                                                  }
                                                  goto __pyx_L130;
                                                  __pyx_L111_error:;
                                                  {
                                                      #ifdef WITH_THREAD
                                                      PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                                      #endif
                                                      #ifdef _OPENMP
                                                      #pragma omp flush(__pyx_parallel_exc_type)
                                                      #endif /* _OPENMP */
                                                      if (!__pyx_parallel_exc_type) {
                                                        <span class='pyx_c_api'>__Pyx_ErrFetchWithState</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                                        __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                                      }
                                                      #ifdef WITH_THREAD
                                                      <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                                      #endif
                                                  }
                                                  __pyx_parallel_why = 4;
                                                  goto __pyx_L129;
                                                  __pyx_L129:;
                                                  #ifdef _OPENMP
                                                  #pragma omp critical(__pyx_parallel_lastprivates10)
                                                  #endif /* _OPENMP */
                                                  {
                                                      __pyx_parallel_temp0 = __pyx_v_ch;
                                                      __pyx_parallel_temp1 = __pyx_v_glcm_val;
                                                      __pyx_parallel_temp2 = __pyx_v_i;
                                                      __pyx_parallel_temp3 = __pyx_v_j;
                                                      __pyx_parallel_temp4 = __pyx_v_mean_i_val;
                                                      __pyx_parallel_temp5 = __pyx_v_mean_j_val;
                                                      __pyx_parallel_temp6 = __pyx_v_var_i_val;
                                                      __pyx_parallel_temp7 = __pyx_v_var_j_val;
                                                  }
                                                  __pyx_L130:;
                                                  #ifdef _OPENMP
                                                  #pragma omp flush(__pyx_parallel_why)
                                                  #endif /* _OPENMP */
                                              }
                                          }
                                          #ifdef _OPENMP
                                          Py_END_ALLOW_THREADS
                                          #else
{
#ifdef WITH_THREAD
                                          PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                          #endif
                                          #endif /* _OPENMP */
                                          #ifdef WITH_THREAD
                                          <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                          #endif
                                          #ifndef _OPENMP
}
#endif /* _OPENMP */
                                      }
                                  }
                                  if (__pyx_parallel_exc_type) {
                                    /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
                                    __pyx_parallel_why = 4;
                                  }
                                  if (__pyx_parallel_why) {
                                    __pyx_v_ch = __pyx_parallel_temp0;
                                    __pyx_v_glcm_val = __pyx_parallel_temp1;
                                    __pyx_v_i = __pyx_parallel_temp2;
                                    __pyx_v_j = __pyx_parallel_temp3;
                                    __pyx_v_mean_i_val = __pyx_parallel_temp4;
                                    __pyx_v_mean_j_val = __pyx_parallel_temp5;
                                    __pyx_v_var_i_val = __pyx_parallel_temp6;
                                    __pyx_v_var_j_val = __pyx_parallel_temp7;
                                    switch (__pyx_parallel_why) {
                                          case 4:
                                      {
                                          #ifdef WITH_THREAD
                                          PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                          #endif
                                          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                                          <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                                          __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                                          #ifdef WITH_THREAD
                                          <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                          #endif
                                      }
                                      goto __pyx_L107_error;
                                    }
                                  }
                              }
                              goto __pyx_L132;
                              __pyx_L107_error:;
                              {
                                  #ifdef WITH_THREAD
                                  PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                  #endif
                                  #ifdef _OPENMP
                                  #pragma omp flush(__pyx_parallel_exc_type)
                                  #endif /* _OPENMP */
                                  if (!__pyx_parallel_exc_type) {
                                    <span class='pyx_c_api'>__Pyx_ErrFetchWithState</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                    __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                  }
                                  #ifdef WITH_THREAD
                                  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                  #endif
                              }
                              __pyx_parallel_why = 4;
                              goto __pyx_L131;
                              __pyx_L131:;
                              #ifdef _OPENMP
                              #pragma omp critical(__pyx_parallel_lastprivates11)
                              #endif /* _OPENMP */
                              {
                                  __pyx_parallel_temp0 = __pyx_v_ch;
                                  __pyx_parallel_temp1 = __pyx_v_glcm_val;
                                  __pyx_parallel_temp2 = __pyx_v_i;
                                  __pyx_parallel_temp3 = __pyx_v_j;
                                  __pyx_parallel_temp4 = __pyx_v_mean_i_val;
                                  __pyx_parallel_temp5 = __pyx_v_mean_j_val;
                                  __pyx_parallel_temp6 = __pyx_v_var_i_val;
                                  __pyx_parallel_temp7 = __pyx_v_var_j_val;
                                  __pyx_parallel_temp8 = __pyx_v_wi_c;
                              }
                              __pyx_L132:;
                              #ifdef _OPENMP
                              #pragma omp flush(__pyx_parallel_why)
                              #endif /* _OPENMP */
                          }
                      }
                      #ifdef _OPENMP
                      Py_END_ALLOW_THREADS
                      #else
{
#ifdef WITH_THREAD
                      PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                      #endif
                      #endif /* _OPENMP */
                      /* Clean up any temporaries */
                      #ifdef WITH_THREAD
                      <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                      #endif
                      #ifndef _OPENMP
}
#endif /* _OPENMP */
                  }
              }
              if (__pyx_parallel_exc_type) {
                /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
                __pyx_parallel_why = 4;
              }
              if (__pyx_parallel_why) {
                __pyx_v_ch = __pyx_parallel_temp0;
                __pyx_v_glcm_val = __pyx_parallel_temp1;
                __pyx_v_i = __pyx_parallel_temp2;
                __pyx_v_j = __pyx_parallel_temp3;
                __pyx_v_mean_i_val = __pyx_parallel_temp4;
                __pyx_v_mean_j_val = __pyx_parallel_temp5;
                __pyx_v_var_i_val = __pyx_parallel_temp6;
                __pyx_v_var_j_val = __pyx_parallel_temp7;
                __pyx_v_wi_c = __pyx_parallel_temp8;
                switch (__pyx_parallel_why) {
                      case 4:
                  {
                      #ifdef WITH_THREAD
                      PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                      #endif
                      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                      <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                      __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                      #ifdef WITH_THREAD
                      <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                      #endif
                  }
                  goto __pyx_L103_error;
                }
              }
          }
          #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
              #undef likely
              #undef unlikely
              #define likely(x)   __builtin_expect(!!(x), 1)
              #define unlikely(x) __builtin_expect(!!(x), 0)
          #endif
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">188</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">189</span>:     <span class="k">return</span> <span class="n">contrast</span><span class="p">,</span> <span class="n">correlation</span><span class="p">,</span> <span class="n">asm</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">var</span></pre>
<pre class='cython code score-16 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_contrast);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_contrast);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_contrast);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_correlation);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_correlation);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_correlation);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_asm);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_asm);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_v_asm);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mean);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mean);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3, __pyx_v_mean);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_var);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_var);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 4, __pyx_v_var);
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">190</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">191</span>: </pre>
</div></body></html>
